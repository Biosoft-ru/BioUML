/* Generated By:JJTree: Do not edit this line. AstEquation.java Version 7.0 */
/* JavaCCOptions:MULTI=true,NODE_USES_PARSER=false,VISITOR=false,TRACK_TOKENS=true,NODE_PREFIX=Ast,NODE_EXTENDS=,NODE_FACTORY=,SUPPORT_CLASS_VISIBILITY_PUBLIC=true */
package biouml.plugins.antimony.astparser_v2;

import biouml.plugins.antimony.AntimonyAstCreator;
import biouml.standard.type.Unit;

public class AstEquation extends SimpleNode
{
    public AstEquation(int id)
    {
        super(id);
    }

    public AstEquation(AntimonyNotationParser p, int id)
    {
        super(p, id);
    }

    public boolean isNumber()
    {
        if( this.jjtGetNumChildren() > 1 )
            return false;
        if( this.jjtGetChild(0) instanceof AstFormulaElement && ( (AstFormulaElement)this.jjtGetChild(0) ).isNumber() )
            return true;
        return false;
    }

    public String getFormula()
    {
        StringBuilder formula = new StringBuilder("");
        for( int i = 0; i < this.jjtGetNumChildren(); i++ )
        {
            formula.append(jjtGetChild(i).toString());
        }
        return formula.toString();
    }

    @Override
    public String toAntimonyString()
    {
        return "";
    }

    public boolean isNumberWithUnit()
    {
        // 2 - number and unit; 4 - number unit / compartment volume
        if( this.jjtGetNumChildren() != 2 && this.jjtGetNumChildren() != 4 )
            return false;
        if( this.jjtGetChild(0) instanceof AstFormulaElement && ( (AstFormulaElement)this.jjtGetChild(0) ).isNumber()
                && this.jjtGetChild(1) instanceof AstFormulaElement && ( (AstFormulaElement)this.jjtGetChild(1) ).isString() )
            return true;
        return false;
    }

    public void setUnit(String units)
    {
        if( !AstSymbol.INIT.equals( ( (AstSymbol)this.jjtGetParent() ).getDeclarationType()) )
            return;

        if( this.isNumberWithUnit() && Unit.UNDEFINED.equals(units) )
            this.removeChild(1);
        else
        {
            AstRegularFormulaElement elem = new AstRegularFormulaElement(AntimonyNotationParser.JJTREGULARFORMULAELEMENT);
            elem.setElement(units);
            elem.setString(true);
            AntimonyAstCreator.createSpace(elem);
            this.addWithDisplacement(elem, 1);
        }

    }

    public boolean hasAmountQuantityType()
    {
        // 3 - number / compartment vol; 4 - number unit / compartment volume
        if( this.jjtGetNumChildren() != 3 && this.jjtGetNumChildren() != 4 )
            return false;
        if( this.jjtGetChild(0) instanceof AstFormulaElement && ( (AstFormulaElement)this.jjtGetChild(0) ).isNumber()
                && this.jjtGetChild(this.jjtGetNumChildren() - 2) instanceof AstRegularFormulaElement
                && ( (AstRegularFormulaElement)this.jjtGetChild(this.jjtGetNumChildren() - 2) ).toString().equals("/")
                && this.jjtGetChild(this.jjtGetNumChildren() - 1) instanceof AstFormulaElement
                && ( (AstFormulaElement)this.jjtGetChild(this.jjtGetNumChildren() - 1) ).isString() )
            return true;
        return false;
    }

}
/* JavaCC - OriginalChecksum=e54a522aa9d2283cb5bb5cd17a1a92ce (do not edit this line) */

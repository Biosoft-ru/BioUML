package biouml.plugins.simulation._test;



/*
 * This code is generated by BioUML FrameWork
 * for BIOMD0000000338 diagram  at 2019.12.12 17:07:12
 */
import biouml.plugins.simulation.ae.AeSolver;
import biouml.plugins.simulation.java.JavaBaseModel;
import ru.biosoft.math.MathRoutines;
import java.util.Map;

public class BIOMD338 extends JavaBaseModel
{

    public double rate_VK_transport;
    public double rate_dAPC;
    public double rate_dAPC_PS;
    public double rate_dCA;
    public double rate_dD;
    public double rate_dF;
    public double rate_dFDP;
    public double rate_dFg;
    public double rate_dII;
    public double rate_dIIa;
    public double rate_dIIa_Tmod;
    public double rate_dIX;
    public double rate_dIXa;
    public double rate_dIXa_VIIIa;
    public double rate_dK;
    public double rate_dP;
    public double rate_dPC;
    public double rate_dPS;
    public double rate_dPg;
    public double rate_dPk;
    public double rate_dTAT;
    public double rate_dTF;
    public double rate_dTFPI;
    public double rate_dTmod;
    public double rate_dV;
    public double rate_dVII;
    public double rate_dVIII;
    public double rate_dVIIIa;
    public double rate_dVII_TF;
    public double rate_dVIIa;
    public double rate_dVIIa_TF;
    public double rate_dVIIa_TF_Xa_TFPI;
    public double rate_dVK;
    public double rate_dVKH2;
    public double rate_dVa;
    public double rate_dVa_Xa;
    public double rate_dX;
    public double rate_dXF;
    public double rate_dXI;
    public double rate_dXII;
    public double rate_dXIII;
    public double rate_dXIIIa;
    public double rate_dXIIa;
    public double rate_dXIa;
    public double rate_dXa;
    public double rate_dXa_TFPI;
    public double rate_eHeparin;
    public double rate_eHeparinIIa;
    public double rate_eHeparinIXa;
    public double rate_eHeparinXa;
    public double rate_pFg;
    public double rate_pII_VKH2;
    public double rate_pIX_VKH2;
    public double rate_pPC_VKH2;
    public double rate_pPS_VKH2;
    public double rate_pPg;
    public double rate_pPk;
    public double rate_pTFPI;
    public double rate_pTmod;
    public double rate_pV;
    public double rate_pVIII;
    public double rate_pVII_VKH2;
    public double rate_pVK;
    public double rate_pXI;
    public double rate_pXII;
    public double rate_pXIII;
    public double rate_pX_VKH2;
    public double rate_r10;
    public double rate_r11;
    public double rate_r12;
    public double rate_r13;
    public double rate_r14;
    public double rate_r15;
    public double rate_r16;
    public double rate_r17;
    public double rate_r18;
    public double rate_r19;
    public double rate_r1_;
    public double rate_r20;
    public double rate_r21;
    public double rate_r22;
    public double rate_r23;
    public double rate_r24;
    public double rate_r25;
    public double rate_r26;
    public double rate_r27;
    public double rate_r28;
    public double rate_r29;
    public double rate_r2_;
    public double rate_r30;
    public double rate_r31;
    public double rate_r32;
    public double rate_r33;
    public double rate_r34;
    public double rate_r35;
    public double rate_r36;
    public double rate_r37;
    public double rate_r38;
    public double rate_r39;
    public double rate_r3_;
    public double rate_r40;
    public double rate_r41;
    public double rate_r42;
    public double rate_r43;
    public double rate_r44;
    public double rate_r45;
    public double rate_r46;
    public double rate_r47;
    public double rate_r48;
    public double rate_r4_;
    public double rate_r5_;
    public double rate_r6_;
    public double rate_r7_;
    public double rate_r8_;
    public double rate_r9_;
    public double compartment_1;
    public double compartment_1_DP;
    public double Fg0;
    public double Heparin_ke;
    public double IC50;
    public double II0;
    public double IX0;
    public double I_max;
    public double PC0;
    public double PS0;
    public double Pg0;
    public double Pk0;
    public double R1;
    public double R2;
    public double RATE_OF_Integral_Fibrin;
    public double RATE_OF_compartment_1_APC;
    public double RATE_OF_compartment_1_APC_PS;
    public double RATE_OF_compartment_1_ATIII_Heparin;
    public double RATE_OF_compartment_1_A_warf;
    public double RATE_OF_compartment_1_CA;
    public double RATE_OF_compartment_1_C_warf;
    public double RATE_OF_compartment_1_D;
    public double RATE_OF_compartment_1_F;
    public double RATE_OF_compartment_1_FDP;
    public double RATE_OF_compartment_1_Fg;
    public double RATE_OF_compartment_1_II;
    public double RATE_OF_compartment_1_IIa;
    public double RATE_OF_compartment_1_IIa_ATIII_Heparin;
    public double RATE_OF_compartment_1_IIa_Tmod;
    public double RATE_OF_compartment_1_IX;
    public double RATE_OF_compartment_1_IXa;
    public double RATE_OF_compartment_1_IXa_ATIII_Heparin;
    public double RATE_OF_compartment_1_IXa_VIIIa;
    public double RATE_OF_compartment_1_K;
    public double RATE_OF_compartment_1_P;
    public double RATE_OF_compartment_1_PC;
    public double RATE_OF_compartment_1_PS;
    public double RATE_OF_compartment_1_Pg;
    public double RATE_OF_compartment_1_Pk;
    public double RATE_OF_compartment_1_TAT;
    public double RATE_OF_compartment_1_TF;
    public double RATE_OF_compartment_1_TFPI;
    public double RATE_OF_compartment_1_Tmod;
    public double RATE_OF_compartment_1_V;
    public double RATE_OF_compartment_1_VII;
    public double RATE_OF_compartment_1_VIII;
    public double RATE_OF_compartment_1_VIIIa;
    public double RATE_OF_compartment_1_VII_TF;
    public double RATE_OF_compartment_1_VIIa;
    public double RATE_OF_compartment_1_VIIa_TF;
    public double RATE_OF_compartment_1_VIIa_TF_Xa_TFPI;
    public double RATE_OF_compartment_1_VK;
    public double RATE_OF_compartment_1_VKH2;
    public double RATE_OF_compartment_1_VKO;
    public double RATE_OF_compartment_1_VK_p;
    public double RATE_OF_compartment_1_Va;
    public double RATE_OF_compartment_1_Va_Xa;
    public double RATE_OF_compartment_1_X;
    public double RATE_OF_compartment_1_XF;
    public double RATE_OF_compartment_1_XI;
    public double RATE_OF_compartment_1_XII;
    public double RATE_OF_compartment_1_XIII;
    public double RATE_OF_compartment_1_XIIIa;
    public double RATE_OF_compartment_1_XIIa;
    public double RATE_OF_compartment_1_XIa;
    public double RATE_OF_compartment_1_Xa;
    public double RATE_OF_compartment_1_Xa_ATIII_Heparin;
    public double RATE_OF_compartment_1_Xa_TFPI;
    public double TFPI0;
    public double Tmod0;
    public double V0;
    public double VII0;
    public double VIII0;
    public double VK0;
    public double VKH20;
    public double VKO0;
    public double VitaminK_Vc;
    public double VitaminK_k12;
    public double VitaminK_k21_Vc;
    public double Warfarin_CL;
    public double Warfarin_Vd;
    public double Warfarin_ka;
    public double Warfarin_ke;
    public double X0;
    public double XI0;
    public double XII0;
    public double XIII0;
    public double assignment;
    public double c44;
    public double c45;
    public double c46;
    public double clottingTime_s;
    public double dAPC_PS_k1;
    public double dAPC_k1;
    public double dCA_k1;
    public double dD_k1;
    public double dFDP_k1;
    public double dF_k1;
    public double dIIa_Tmod_k1;
    public double dIIa_k1;
    public double dIXa_VIIIa_k1;
    public double dIXa_k1;
    public double dK_k1;
    public double dP_k1;
    public double dTAT_k1;
    public double dTF_k1;
    public double dVIIIa_k1;
    public double dVII_TF_k1;
    public double dVIIa_TF_Xa_TFPI_k1;
    public double dVIIa_TF_k1;
    public double dVIIa_k1;
    public double dVa_Xa_k1;
    public double dVa_k1;
    public double dXF_k1;
    public double dXIIIa_k1;
    public double dXIIa_k1;
    public double dXI_k1;
    public double dXIa_k1;
    public double dXa_TFPI_k1;
    public double dXa_k1;
    public double d_Fg;
    public double d_II;
    public double d_IX;
    public double d_PC;
    public double d_PS;
    public double d_Pg;
    public double d_Pk;
    public double d_TFPI;
    public double d_Tmod;
    public double d_V;
    public double d_VII;
    public double d_VIII;
    public double d_VK;
    public double d_VK2;
    public double d_VKH2;
    public double d_VKO;
    public double d_X;
    public double d_XI;
    public double d_XII;
    public double d_XIII;
    public double r10_k;
    public double r10_v;
    public double r11_k;
    public double r11_v;
    public double r12_k;
    public double r12_v;
    public double r13_k;
    public double r13_v;
    public double r14_k;
    public double r14_v;
    public double r15_k;
    public double r15_v;
    public double r16_k;
    public double r16_v;
    public double r17_k;
    public double r17_v;
    public double r18_k;
    public double r18_v;
    public double r19_k;
    public double r19_v;
    public double r1__k;
    public double r1__v;
    public double r20_k;
    public double r20_v;
    public double r21_k;
    public double r21_v;
    public double r22_k;
    public double r22_v;
    public double r23_k;
    public double r23_v;
    public double r24_k;
    public double r24_v;
    public double r25_k;
    public double r25_v;
    public double r26_c;
    public double r27_c;
    public double r28_c;
    public double r29_c;
    public double r2__k;
    public double r2__v;
    public double r30_c;
    public double r31_c;
    public double r32_c;
    public double r33_k;
    public double r33_v;
    public double r34_k;
    public double r34_v;
    public double r35_k;
    public double r35_v;
    public double r36_k;
    public double r36_v;
    public double r37_c;
    public double r38_k;
    public double r38_v;
    public double r39_k;
    public double r39_v;
    public double r3__k;
    public double r3__v;
    public double r40_k;
    public double r40_v;
    public double r41_k;
    public double r41_v;
    public double r42_k;
    public double r42_v;
    public double r43_k;
    public double r43_v;
    public double r4__k;
    public double r4__v;
    public double r5__k;
    public double r5__v;
    public double r6__k;
    public double r6__v;
    public double r7__k;
    public double r7__v;
    public double r8__k;
    public double r8__v;
    public double r9__k;
    public double r9__v;

     public double[] getY()
     {
         return x_values;
     }



    private void calculateParameters() throws Exception
    {
        double[] x_values = this.x_values;
        RATE_OF_compartment_1_CA = -rate_dCA/compartment_1;
        RATE_OF_Integral_Fibrin = x_values[7]/compartment_1;
        RATE_OF_compartment_1_VKO = (rate_dVKH2 - rate_r48)/compartment_1;
        RATE_OF_compartment_1_IXa_ATIII_Heparin = (-rate_eHeparinIXa + rate_r46)/compartment_1;
        RATE_OF_compartment_1_XIa = (-rate_dXIa + rate_r4_ + rate_r5_)/compartment_1;
        RATE_OF_compartment_1_TAT = (rate_dIIa - rate_dTAT)/compartment_1;
        RATE_OF_compartment_1_C_warf = Warfarin_ka*(x_values[3]/compartment_1)/Warfarin_Vd - Warfarin_ke*(x_values[5]/compartment_1);
        RATE_OF_compartment_1_Xa_ATIII_Heparin = (-rate_eHeparinXa + rate_r45)/compartment_1;
        compartment_1_DP = (x_values[8]/compartment_1 + x_values[6]/compartment_1)*compartment_1;
        RATE_OF_compartment_1_Pk = (-rate_dPk + rate_pPk - rate_r43)/compartment_1;
        RATE_OF_compartment_1_FDP = (rate_dF - rate_dFDP + rate_dFg + rate_r15 + rate_r17)/compartment_1;
        RATE_OF_compartment_1_XIIa = (-rate_dXIIa + rate_r41 + rate_r42)/compartment_1;
        RATE_OF_compartment_1_A_warf = -Warfarin_ka*(x_values[3]/compartment_1);
        RATE_OF_compartment_1_XI = (-rate_dXI + rate_pXI - rate_r4_ - rate_r5_)/compartment_1;
        RATE_OF_compartment_1_APC_PS = (-rate_dAPC_PS + rate_r37)/compartment_1;
        RATE_OF_compartment_1_PS = (-rate_dPS + rate_pPS_VKH2 - rate_r37)/compartment_1;
        RATE_OF_compartment_1_VKH2 = (-rate_dVKH2 + rate_r47)/compartment_1;
        RATE_OF_compartment_1_Xa_TFPI = (-rate_dXa_TFPI - rate_r31 + rate_r32)/compartment_1;
        RATE_OF_compartment_1_Fg = (-rate_dFg + rate_pFg - rate_r14 - rate_r15)/compartment_1;
        RATE_OF_compartment_1_XF = (-rate_dXF + rate_r16 - rate_r18 - rate_r19)/compartment_1;
        RATE_OF_compartment_1_TFPI = (-rate_dTFPI + rate_pTFPI - rate_r32)/compartment_1;
        RATE_OF_compartment_1_VK_p = rate_VK_transport/compartment_1;
        RATE_OF_compartment_1_VK = (-rate_VK_transport - rate_dVK + rate_pVK - rate_r47 + rate_r48)/compartment_1;
        RATE_OF_compartment_1_XII = (-rate_dXII + rate_pXII - rate_r41 - rate_r42)/compartment_1;
        RATE_OF_compartment_1_VII = (-rate_dVII + rate_pVII_VKH2 - rate_r30 - rate_r38 - rate_r39 - rate_r40 - rate_r6_)/compartment_1;
        RATE_OF_compartment_1_V = (-rate_dV + rate_pV - rate_r10)/compartment_1;
        RATE_OF_compartment_1_VII_TF = (-rate_dVII_TF + rate_r30 - rate_r33 - rate_r36)/compartment_1;
        RATE_OF_compartment_1_II = (-rate_dII + rate_pII_VKH2 - rate_r12 - rate_r13)/compartment_1;
        RATE_OF_compartment_1_ATIII_Heparin = (-rate_eHeparin - rate_r44 - rate_r45 - rate_r46)/compartment_1;
        RATE_OF_compartment_1_PC = (-rate_dPC + rate_pPC_VKH2 - rate_r24)/compartment_1;
        RATE_OF_compartment_1_APC = (-rate_dAPC + rate_r24 - rate_r37)/compartment_1;
        RATE_OF_compartment_1_IXa_VIIIa = (-rate_dIXa_VIIIa + rate_r26)/compartment_1;
        RATE_OF_compartment_1_VIIIa = (-rate_dVIIIa + rate_r1_ - rate_r26 - rate_r2_)/compartment_1;
        RATE_OF_compartment_1_IXa = (-rate_dIXa - rate_r26 + rate_r35 + rate_r3_ - rate_r46)/compartment_1;
        RATE_OF_compartment_1_XIIIa = (-rate_dXIIIa + rate_r20)/compartment_1;
        RATE_OF_compartment_1_IIa_ATIII_Heparin = (-rate_eHeparinIIa + rate_r44)/compartment_1;
        RATE_OF_compartment_1_VIII = (-rate_dVIII + rate_pVIII - rate_r1_)/compartment_1;
        RATE_OF_compartment_1_Pg = (-rate_dPg + rate_pPg - rate_r21 - rate_r22 - rate_r23)/compartment_1;
        RATE_OF_compartment_1_P = (-rate_dP + rate_r21 + rate_r22 + rate_r23)/compartment_1;
        RATE_OF_compartment_1_D = (-rate_dD + rate_dXF + rate_r18 + rate_r19)/compartment_1;
        RATE_OF_compartment_1_IX = (-rate_dIX + rate_pIX_VKH2 - rate_r35 - rate_r3_)/compartment_1;
        RATE_OF_compartment_1_VIIa_TF_Xa_TFPI = (-rate_dVIIa_TF_Xa_TFPI + rate_r31)/compartment_1;
        RATE_OF_compartment_1_F = (-rate_dF + rate_r14 - rate_r16 - rate_r17)/compartment_1;
        RATE_OF_compartment_1_Va = (-rate_dVa + rate_r10 - rate_r11 - rate_r27)/compartment_1;
        RATE_OF_compartment_1_Va_Xa = (-rate_dVa_Xa - rate_r25 + rate_r27)/compartment_1;
        RATE_OF_compartment_1_XIII = (-rate_dXIII + rate_pXIII - rate_r20)/compartment_1;
        RATE_OF_compartment_1_Tmod = (-rate_dTmod + rate_pTmod - rate_r28)/compartment_1;
        RATE_OF_compartment_1_IIa = (-rate_dIIa + rate_r12 + rate_r13 - rate_r28 - rate_r44)/compartment_1;
        RATE_OF_compartment_1_IIa_Tmod = (-rate_dIIa_Tmod + rate_r28)/compartment_1;
        RATE_OF_compartment_1_Xa = (-rate_dXa - rate_r27 - rate_r32 + rate_r34 - rate_r45 + rate_r7_ + rate_r8_ + rate_r9_)/compartment_1;
        RATE_OF_compartment_1_X = (-rate_dX + rate_pX_VKH2 - rate_r34 - rate_r7_ - rate_r8_ - rate_r9_)/compartment_1;
        RATE_OF_compartment_1_VIIa = (-rate_dVIIa - rate_r29 + rate_r38 + rate_r39 + rate_r40 + rate_r6_)/compartment_1;
        RATE_OF_compartment_1_TF = (-rate_dTF - rate_r29 - rate_r30)/compartment_1;
        RATE_OF_compartment_1_VIIa_TF = (-rate_dVIIa_TF + rate_r29 - rate_r31 + rate_r33 + rate_r36)/compartment_1;
        RATE_OF_compartment_1_K = (-rate_dK + rate_r43)/compartment_1;
    }


    private void calculateReactionRates()
    {
        double[] x_values = this.x_values;
        rate_dII = compartment_1*d_II*(x_values[10]/compartment_1);
        rate_dPk = compartment_1*d_Pk*(x_values[23]/compartment_1);
        rate_pPk = compartment_1*Factor_production(Pk0, d_Pk);
        rate_pX_VKH2 = compartment_1*VKH2mediated_factor_production(d_X, X0, x_values[37]/compartment_1, VKH20);
        rate_pPg = compartment_1*Factor_production(Pg0, d_Pg);
        rate_dIX = compartment_1*d_IX*(x_values[14]/compartment_1);
        rate_r4_ = compartment_1*Hyperbolic_rate_law(r4__v, x_values[44]/compartment_1, x_values[48]/compartment_1, r4__k);
        rate_eHeparinIIa = compartment_1*Heparin_ke*(x_values[12]/compartment_1);
        rate_r2_ = compartment_1*Hyperbolic_rate_law(r2__v, x_values[31]/compartment_1, x_values[1]/compartment_1, r2__k);
        rate_pXI = compartment_1*Factor_production(XI0, d_XI);
        rate_dXa = compartment_1*dXa_k1*(x_values[50]/compartment_1);
        rate_dAPC_PS = compartment_1*dAPC_PS_k1*(x_values[1]/compartment_1);
        rate_r40 = compartment_1*Hyperbolic_rate_law(r40_v, x_values[29]/compartment_1, x_values[15]/compartment_1, r40_k);
        rate_dPS = compartment_1*d_PS*(x_values[21]/compartment_1);
        rate_r45 = compartment_1*Irreversible_association(x_values[50]/compartment_1, x_values[2]/compartment_1, c45);
        rate_r46 = compartment_1*Irreversible_association(x_values[15]/compartment_1, x_values[2]/compartment_1, c46);
        rate_r47 = compartment_1*Warfarin_inhibited_first_order_kinetics(I_max, x_values[5]/compartment_1, IC50, x_values[36]/compartment_1, d_VK2);
        rate_dVa_Xa = compartment_1*dVa_Xa_k1*(x_values[41]/compartment_1);
        rate_r48 = compartment_1*Warfarin_inhibited_first_order_kinetics(I_max, x_values[5]/compartment_1, IC50, x_values[38]/compartment_1, d_VKO);
        rate_r41 = compartment_1*sep(r41_v, x_values[45]/compartment_1, x_values[4]/compartment_1, r41_k);
        rate_r42 = compartment_1*sep(r42_v, x_values[45]/compartment_1, x_values[18]/compartment_1, r42_k);
        rate_r43 = compartment_1*sep(r43_v, x_values[23]/compartment_1, x_values[48]/compartment_1, r43_k);
        rate_r44 = compartment_1*Irreversible_association(x_values[11]/compartment_1, x_values[2]/compartment_1, c44);
        rate_dPg = compartment_1*d_Pg*(x_values[22]/compartment_1);
        rate_r3_ = compartment_1*Hyperbolic_rate_law(r3__v, x_values[14]/compartment_1, x_values[49]/compartment_1, r3__k);
        rate_VK_transport = compartment_1*(VitaminK_k12*(x_values[36]/compartment_1) - VitaminK_k21_Vc*(x_values[39]/compartment_1));
        rate_dP = compartment_1*dP_k1*(x_values[19]/compartment_1);
        rate_dCA = compartment_1*dCA_k1*(x_values[4]/compartment_1);
        rate_dF = compartment_1*dF_k1*(x_values[7]/compartment_1);
        rate_dXII = compartment_1*d_XII*(x_values[45]/compartment_1);
        rate_dVKH2 = compartment_1*d_VKH2*(x_values[37]/compartment_1);
        rate_dK = compartment_1*dK_k1*(x_values[18]/compartment_1);
        rate_dTF = compartment_1*dTF_k1*(x_values[25]/compartment_1);
        rate_dVIIIa = compartment_1*dVIIIa_k1*(x_values[31]/compartment_1);
        rate_r6_ = compartment_1*Hyperbolic_rate_law(r6__v, x_values[29]/compartment_1, x_values[11]/compartment_1, r6__k);
        rate_dV = compartment_1*d_V*(x_values[28]/compartment_1);
        rate_pPC_VKH2 = compartment_1*VKH2mediated_factor_production(d_PC, PC0, x_values[37]/compartment_1, VKH20);
        rate_dX = compartment_1*d_X*(x_values[42]/compartment_1);
        rate_eHeparinIXa = compartment_1*Heparin_ke*(x_values[16]/compartment_1);
        rate_dXIIIa = compartment_1*dXIIIa_k1*(x_values[47]/compartment_1);
        rate_dXIa = compartment_1*dXIa_k1*(x_values[49]/compartment_1);
        rate_dD = compartment_1*dD_k1*(x_values[6]/compartment_1);
        rate_r5_ = compartment_1*Hyperbolic_rate_law(r5__v, x_values[44]/compartment_1, x_values[11]/compartment_1, r5__k);
        rate_dTAT = compartment_1*dTAT_k1*(x_values[24]/compartment_1);
        rate_eHeparin = compartment_1*Heparin_ke*(x_values[2]/compartment_1);
        rate_pII_VKH2 = compartment_1*VKH2mediated_factor_production(d_II, II0, x_values[37]/compartment_1, VKH20);
        rate_dIIa = compartment_1*dIIa_k1*(x_values[11]/compartment_1);
        rate_pPS_VKH2 = compartment_1*VKH2mediated_factor_production(d_PS, PS0, x_values[37]/compartment_1, VKH20);
        rate_eHeparinXa = compartment_1*Heparin_ke*(x_values[51]/compartment_1);
        rate_r12 = compartment_1*Hyperbolic_rate_law(r12_v, x_values[10]/compartment_1, x_values[41]/compartment_1, r12_k);
        rate_r13 = compartment_1*Hyperbolic_rate_law(r13_v, x_values[10]/compartment_1, x_values[50]/compartment_1, r13_k);
        rate_r14 = compartment_1*Hyperbolic_rate_law(r14_v, x_values[9]/compartment_1, x_values[11]/compartment_1, r14_k);
        rate_r15 = compartment_1*Hyperbolic_rate_law(r15_v, x_values[9]/compartment_1, x_values[19]/compartment_1, r15_k);
        rate_pIX_VKH2 = compartment_1*VKH2mediated_factor_production(d_IX, IX0, x_values[37]/compartment_1, VKH20);
        rate_r10 = compartment_1*Hyperbolic_rate_law(r10_v, x_values[28]/compartment_1, x_values[11]/compartment_1, r10_k);
        rate_r11 = compartment_1*Hyperbolic_rate_law(r11_v, x_values[40]/compartment_1, x_values[1]/compartment_1, r11_k);
        rate_dTmod = compartment_1*d_Tmod*(x_values[27]/compartment_1);
        rate_dVIIa = compartment_1*dVIIa_k1*(x_values[33]/compartment_1);
        rate_r16 = compartment_1*Hyperbolic_rate_law(r16_v, x_values[7]/compartment_1, x_values[47]/compartment_1, r16_k);
        rate_r17 = compartment_1*Hyperbolic_rate_law(r17_v, x_values[7]/compartment_1, x_values[19]/compartment_1, r17_k);
        rate_dVK = compartment_1*d_VK*(x_values[36]/compartment_1);
        rate_r18 = compartment_1*Hyperbolic_rate_law(r18_v, x_values[43]/compartment_1, x_values[19]/compartment_1, r18_k);
        rate_r8_ = compartment_1*Hyperbolic_rate_law(r8__v, x_values[42]/compartment_1, x_values[17]/compartment_1, r8__k);
        rate_r19 = compartment_1*Hyperbolic_rate_law(r19_v, x_values[43]/compartment_1, x_values[1]/compartment_1, r19_k);
        rate_pVII_VKH2 = compartment_1*VKH2mediated_factor_production(d_VII, VII0, x_values[37]/compartment_1, VKH20);
        rate_dVIIa_TF_Xa_TFPI = compartment_1*dVIIa_TF_Xa_TFPI_k1*(x_values[35]/compartment_1);
        rate_pTFPI = compartment_1*Factor_production(TFPI0, d_TFPI);
        rate_dVIII = compartment_1*d_VIII*(x_values[30]/compartment_1);
        rate_dFDP = compartment_1*dFDP_k1*(x_values[8]/compartment_1);
        rate_pXIII = compartment_1*Factor_production(XIII0, d_XIII);
        rate_r7_ = compartment_1*Hyperbolic_rate_law(r7__v, x_values[42]/compartment_1, x_values[15]/compartment_1, r7__k);
        rate_dFg = compartment_1*d_Fg*(x_values[9]/compartment_1);
        rate_r1_ = compartment_1*Hyperbolic_rate_law(r1__v, x_values[30]/compartment_1, x_values[11]/compartment_1, r1__k);
        rate_dXIIa = compartment_1*dXIIa_k1*(x_values[48]/compartment_1);
        rate_dXa_TFPI = compartment_1*dXa_TFPI_k1*(x_values[52]/compartment_1);
        rate_pV = compartment_1*Factor_production(V0, d_V);
        rate_dVII = compartment_1*d_VII*(x_values[29]/compartment_1);
        rate_r34 = compartment_1*Hyperbolic_rate_law(r34_v, x_values[42]/compartment_1, x_values[34]/compartment_1, r34_k);
        rate_r35 = compartment_1*Hyperbolic_rate_law(r35_v, x_values[14]/compartment_1, x_values[34]/compartment_1, r35_k);
        rate_r36 = compartment_1*Hyperbolic_rate_law(r36_v, x_values[32]/compartment_1, x_values[25]/compartment_1, r36_k);
        rate_dXI = compartment_1*dXI_k1*(x_values[44]/compartment_1);
        rate_dAPC = compartment_1*dAPC_k1*(x_values[0]/compartment_1);
        rate_r37 = compartment_1*Irreversible_association(x_values[0]/compartment_1, x_values[21]/compartment_1, r37_c);
        rate_r30 = compartment_1*Irreversible_association(x_values[29]/compartment_1, x_values[25]/compartment_1, r30_c);
        rate_r31 = compartment_1*Irreversible_association(x_values[34]/compartment_1, x_values[52]/compartment_1, r31_c);
        rate_dIXa_VIIIa = compartment_1*dIXa_VIIIa_k1*(x_values[17]/compartment_1);
        rate_r32 = compartment_1*Irreversible_association(x_values[50]/compartment_1, x_values[26]/compartment_1, r32_c);
        rate_pFg = compartment_1*Factor_production(Fg0, d_Fg);
        rate_r33 = compartment_1*Hyperbolic_rate_law(r33_v, x_values[32]/compartment_1, x_values[50]/compartment_1, r33_k);
        rate_dXF = compartment_1*dXF_k1*(x_values[43]/compartment_1);
        rate_dTFPI = compartment_1*d_TFPI*(x_values[26]/compartment_1);
        rate_dPC = compartment_1*d_PC*(x_values[20]/compartment_1);
        rate_r38 = compartment_1*Hyperbolic_rate_law(r38_v, x_values[29]/compartment_1, x_values[50]/compartment_1, r38_k);
        rate_r39 = compartment_1*Hyperbolic_rate_law(r39_v, x_values[29]/compartment_1, x_values[34]/compartment_1, r39_k);
        rate_pVK = compartment_1*Factor_production(VK0, d_VK);
        rate_pXII = compartment_1*Factor_production(XII0, d_XII);
        rate_dVIIa_TF = compartment_1*dVIIa_TF_k1*(x_values[34]/compartment_1);
        rate_pTmod = compartment_1*Factor_production(Tmod0, d_Tmod);
        rate_dVII_TF = compartment_1*dVII_TF_k1*(x_values[32]/compartment_1);
        rate_r23 = compartment_1*Hyperbolic_rate_law(r23_v, x_values[22]/compartment_1, x_values[1]/compartment_1, r23_k);
        rate_r24 = compartment_1*Hyperbolic_rate_law(r24_v, x_values[20]/compartment_1, x_values[13]/compartment_1, r24_k);
        rate_r25 = compartment_1*Hyperbolic_rate_law(r25_v, x_values[41]/compartment_1, x_values[1]/compartment_1, r25_k);
        rate_r26 = compartment_1*Irreversible_association(x_values[15]/compartment_1, x_values[31]/compartment_1, r26_c);
        rate_dIXa = compartment_1*dIXa_k1*(x_values[15]/compartment_1);
        rate_dIIa_Tmod = compartment_1*dIIa_Tmod_k1*(x_values[13]/compartment_1);
        rate_dVa = compartment_1*dVa_k1*(x_values[40]/compartment_1);
        rate_r20 = compartment_1*Hyperbolic_rate_law(r20_v, x_values[46]/compartment_1, x_values[11]/compartment_1, r20_k);
        rate_r21 = compartment_1*Hyperbolic_rate_law(r21_v, x_values[22]/compartment_1, x_values[11]/compartment_1, r21_k);
        rate_pVIII = compartment_1*Factor_production(VIII0, d_VIII);
        rate_r22 = compartment_1*Hyperbolic_rate_law(r22_v, x_values[22]/compartment_1, x_values[7]/compartment_1, r22_k);
        rate_r27 = compartment_1*Irreversible_association(x_values[40]/compartment_1, x_values[50]/compartment_1, r27_c);
        rate_dXIII = compartment_1*d_XIII*(x_values[46]/compartment_1);
        rate_r28 = compartment_1*Irreversible_association(x_values[11]/compartment_1, x_values[27]/compartment_1, r28_c);
        rate_r9_ = compartment_1*Hyperbolic_rate_law(r9__v, x_values[42]/compartment_1, x_values[33]/compartment_1, r9__k);
        rate_r29 = compartment_1*Irreversible_association(x_values[33]/compartment_1, x_values[25]/compartment_1, r29_c);
    }


    private void calculateInitialParameters()
    {
        double[] x_values = this.x_values;
        rate_pPk = compartment_1*Factor_production(Pk0, d_Pk);
        x_values[49] = XI0*0.148*compartment_1;
        x_values[20] = PC0*compartment_1;
        rate_pPg = compartment_1*Factor_production(Pg0, d_Pg);
        x_values[21] = PS0*compartment_1;
        c44 = c45*R1;
        x_values[23] = Pk0*compartment_1;
        c46 = c45*R2;
        x_values[22] = Pg0*compartment_1;
        x_values[32] = 0.0;
        x_values[39] = 0.0;
        x_values[12] = 0.0;
        x_values[1] = 0.0;
        rate_dAPC_PS = compartment_1*dAPC_PS_k1*(x_values[1]/compartment_1);
        x_values[29] = VII0*compartment_1;
        x_values[52] = 0.0;
        x_values[0] = 0.0;
        d_VKO = d_VK2*VK0/VKO0;
        x_values[15] = 0.0;
        rate_r40 = compartment_1*Hyperbolic_rate_law(r40_v, x_values[29]/compartment_1, x_values[15]/compartment_1, r40_k);
        x_values[31] = 0.0;
        rate_r2_ = compartment_1*Hyperbolic_rate_law(r2__v, x_values[31]/compartment_1, x_values[1]/compartment_1, r2__k);
        x_values[17] = 0.0;
        x_values[19] = 0.0;
        rate_dP = compartment_1*dP_k1*(x_values[19]/compartment_1);
        x_values[28] = V0*compartment_1;
        rate_dV = compartment_1*d_V*(x_values[28]/compartment_1);
        x_values[42] = X0*compartment_1;
        rate_dX = compartment_1*d_X*(x_values[42]/compartment_1);
        rate_r8_ = compartment_1*Hyperbolic_rate_law(r8__v, x_values[42]/compartment_1, x_values[17]/compartment_1, r8__k);
        x_values[34] = 0.0;
        x_values[11] = 0.0;
        rate_r6_ = compartment_1*Hyperbolic_rate_law(r6__v, x_values[29]/compartment_1, x_values[11]/compartment_1, r6__k);
        rate_dIIa = compartment_1*dIIa_k1*(x_values[11]/compartment_1);
        rate_r7_ = compartment_1*Hyperbolic_rate_law(r7__v, x_values[42]/compartment_1, x_values[15]/compartment_1, r7__k);
        rate_dXa_TFPI = compartment_1*dXa_TFPI_k1*(x_values[52]/compartment_1);
        x_values[8] = 0.0;
        rate_dFDP = compartment_1*dFDP_k1*(x_values[8]/compartment_1);
        rate_pV = compartment_1*Factor_production(V0, d_V);
        rate_pFg = compartment_1*Factor_production(Fg0, d_Fg);
        rate_dIXa_VIIIa = compartment_1*dIXa_VIIIa_k1*(x_values[17]/compartment_1);
        x_values[6] = 0.0;
        rate_dD = compartment_1*dD_k1*(x_values[6]/compartment_1);
        x_values[7] = 0.0;
        rate_dF = compartment_1*dF_k1*(x_values[7]/compartment_1);
        rate_dPC = compartment_1*d_PC*(x_values[20]/compartment_1);
        x_values[18] = 0.0;
        rate_dK = compartment_1*dK_k1*(x_values[18]/compartment_1);
        x_values[45] = XII0*compartment_1;
        rate_r42 = compartment_1*sep(r42_v, x_values[45]/compartment_1, x_values[18]/compartment_1, r42_k);
        rate_pVK = compartment_1*Factor_production(VK0, d_VK);
        x_values[30] = VIII0*compartment_1;
        x_values[24] = 0.0;
        rate_dIXa = compartment_1*dIXa_k1*(x_values[15]/compartment_1);
        x_values[33] = 0.0;
        rate_pVIII = compartment_1*Factor_production(VIII0, d_VIII);
        rate_r9_ = compartment_1*Hyperbolic_rate_law(r9__v, x_values[42]/compartment_1, x_values[33]/compartment_1, r9__k);
        rate_dPk = compartment_1*d_Pk*(x_values[23]/compartment_1);
        x_values[3] = 0.0;
        RATE_OF_compartment_1_A_warf = -Warfarin_ka*(x_values[3]/compartment_1);
        x_values[50] = 0.0;
        rate_dXa = compartment_1*dXa_k1*(x_values[50]/compartment_1);
        rate_eHeparinIIa = compartment_1*Heparin_ke*(x_values[12]/compartment_1);
        x_values[10] = II0*compartment_1;
        rate_dII = compartment_1*d_II*(x_values[10]/compartment_1);
        rate_pXI = compartment_1*Factor_production(XI0, d_XI);
        x_values[37] = VKH20*compartment_1;
        rate_pX_VKH2 = compartment_1*VKH2mediated_factor_production(d_X, X0, x_values[37]/compartment_1, VKH20);
        rate_pPC_VKH2 = compartment_1*VKH2mediated_factor_production(d_PC, PC0, x_values[37]/compartment_1, VKH20);
        rate_pPS_VKH2 = compartment_1*VKH2mediated_factor_production(d_PS, PS0, x_values[37]/compartment_1, VKH20);
        rate_pIX_VKH2 = compartment_1*VKH2mediated_factor_production(d_IX, IX0, x_values[37]/compartment_1, VKH20);
        rate_dPS = compartment_1*d_PS*(x_values[21]/compartment_1);
        x_values[2] = 0.0;
        rate_r45 = compartment_1*Irreversible_association(x_values[50]/compartment_1, x_values[2]/compartment_1, c45);
        rate_r46 = compartment_1*Irreversible_association(x_values[15]/compartment_1, x_values[2]/compartment_1, c46);
        rate_r44 = compartment_1*Irreversible_association(x_values[11]/compartment_1, x_values[2]/compartment_1, c44);
        x_values[14] = IX0*compartment_1;
        rate_dIX = compartment_1*d_IX*(x_values[14]/compartment_1);
        rate_r3_ = compartment_1*Hyperbolic_rate_law(r3__v, x_values[14]/compartment_1, x_values[49]/compartment_1, r3__k);
        rate_dPg = compartment_1*d_Pg*(x_values[22]/compartment_1);
        x_values[5] = 0.0;
        x_values[36] = VK0*compartment_1;
        rate_r47 = compartment_1*Warfarin_inhibited_first_order_kinetics(I_max, x_values[5]/compartment_1, IC50, x_values[36]/compartment_1, d_VK2);
        RATE_OF_Integral_Fibrin = x_values[7]/compartment_1;
        rate_dXII = compartment_1*d_XII*(x_values[45]/compartment_1);
        x_values[40] = 0.0;
        rate_dVIIIa = compartment_1*dVIIIa_k1*(x_values[31]/compartment_1);
        d_VKH2 = d_VK2*VK0/VKH20;
        rate_dVKH2 = compartment_1*d_VKH2*(x_values[37]/compartment_1);
        x_values[51] = 0.0;
        x_values[9] = Fg0*compartment_1;
        rate_dXIa = compartment_1*dXIa_k1*(x_values[49]/compartment_1);
        x_values[44] = XI0*0.339*compartment_1;
        rate_r5_ = compartment_1*Hyperbolic_rate_law(r5__v, x_values[44]/compartment_1, x_values[11]/compartment_1, r5__k);
        x_values[43] = 0.0;
        rate_dTAT = compartment_1*dTAT_k1*(x_values[24]/compartment_1);
        RATE_OF_compartment_1_TAT = (rate_dIIa - rate_dTAT)/compartment_1;
        rate_eHeparin = compartment_1*Heparin_ke*(x_values[2]/compartment_1);
        RATE_OF_compartment_1_ATIII_Heparin = (-rate_eHeparin - rate_r44 - rate_r45 - rate_r46)/compartment_1;
        rate_pII_VKH2 = compartment_1*VKH2mediated_factor_production(d_II, II0, x_values[37]/compartment_1, VKH20);
        x_values[25] = 0.0;
        rate_dTF = compartment_1*dTF_k1*(x_values[25]/compartment_1);
        x_values[13] = 0.0;
        rate_dIIa_Tmod = compartment_1*dIIa_Tmod_k1*(x_values[13]/compartment_1);
        rate_eHeparinXa = compartment_1*Heparin_ke*(x_values[51]/compartment_1);
        RATE_OF_compartment_1_Xa_ATIII_Heparin = (-rate_eHeparinXa + rate_r45)/compartment_1;
        compartment_1_DP = (x_values[8]/compartment_1 + x_values[6]/compartment_1)*compartment_1;
        rate_r13 = compartment_1*Hyperbolic_rate_law(r13_v, x_values[10]/compartment_1, x_values[50]/compartment_1, r13_k);
        rate_r14 = compartment_1*Hyperbolic_rate_law(r14_v, x_values[9]/compartment_1, x_values[11]/compartment_1, r14_k);
        VitaminK_k21_Vc = 0.0122/VitaminK_Vc;
        rate_VK_transport = compartment_1*(VitaminK_k12*(x_values[36]/compartment_1) - VitaminK_k21_Vc*(x_values[39]/compartment_1));
        RATE_OF_compartment_1_VK_p = rate_VK_transport/compartment_1;
        rate_r15 = compartment_1*Hyperbolic_rate_law(r15_v, x_values[9]/compartment_1, x_values[19]/compartment_1, r15_k);
        x_values[46] = XIII0*compartment_1;
        rate_dXIII = compartment_1*d_XIII*(x_values[46]/compartment_1);
        rate_r10 = compartment_1*Hyperbolic_rate_law(r10_v, x_values[28]/compartment_1, x_values[11]/compartment_1, r10_k);
        rate_r11 = compartment_1*Hyperbolic_rate_law(r11_v, x_values[40]/compartment_1, x_values[1]/compartment_1, r11_k);
        rate_dVIIa = compartment_1*dVIIa_k1*(x_values[33]/compartment_1);
        rate_r17 = compartment_1*Hyperbolic_rate_law(r17_v, x_values[7]/compartment_1, x_values[19]/compartment_1, r17_k);
        rate_r18 = compartment_1*Hyperbolic_rate_law(r18_v, x_values[43]/compartment_1, x_values[19]/compartment_1, r18_k);
        rate_dVK = compartment_1*d_VK*(x_values[36]/compartment_1);
        rate_r19 = compartment_1*Hyperbolic_rate_law(r19_v, x_values[43]/compartment_1, x_values[1]/compartment_1, r19_k);
        x_values[38] = VKO0*compartment_1;
        rate_r48 = compartment_1*Warfarin_inhibited_first_order_kinetics(I_max, x_values[5]/compartment_1, IC50, x_values[38]/compartment_1, d_VKO);
        RATE_OF_compartment_1_VKO = (rate_dVKH2 - rate_r48)/compartment_1;
        RATE_OF_compartment_1_VK = (-rate_VK_transport - rate_dVK + rate_pVK - rate_r47 + rate_r48)/compartment_1;
        x_values[41] = 0.0;
        rate_dVa_Xa = compartment_1*dVa_Xa_k1*(x_values[41]/compartment_1);
        rate_r12 = compartment_1*Hyperbolic_rate_law(r12_v, x_values[10]/compartment_1, x_values[41]/compartment_1, r12_k);
        rate_pVII_VKH2 = compartment_1*VKH2mediated_factor_production(d_VII, VII0, x_values[37]/compartment_1, VKH20);
        rate_pTFPI = compartment_1*Factor_production(TFPI0, d_TFPI);
        x_values[26] = TFPI0*compartment_1;
        rate_dTFPI = compartment_1*d_TFPI*(x_values[26]/compartment_1);
        rate_dVIII = compartment_1*d_VIII*(x_values[30]/compartment_1);
        x_values[35] = 0.0;
        rate_dVIIa_TF_Xa_TFPI = compartment_1*dVIIa_TF_Xa_TFPI_k1*(x_values[35]/compartment_1);
        rate_pXIII = compartment_1*Factor_production(XIII0, d_XIII);
        Warfarin_ke = Warfarin_CL/Warfarin_Vd;
        RATE_OF_compartment_1_C_warf = Warfarin_ka*(x_values[3]/compartment_1)/Warfarin_Vd - Warfarin_ke*(x_values[5]/compartment_1);
        x_values[48] = 0.0;
        rate_r4_ = compartment_1*Hyperbolic_rate_law(r4__v, x_values[44]/compartment_1, x_values[48]/compartment_1, r4__k);
        rate_r43 = compartment_1*sep(r43_v, x_values[23]/compartment_1, x_values[48]/compartment_1, r43_k);
        RATE_OF_compartment_1_Pk = (-rate_dPk + rate_pPk - rate_r43)/compartment_1;
        rate_dXIIa = compartment_1*dXIIa_k1*(x_values[48]/compartment_1);
        RATE_OF_compartment_1_XIa = (-rate_dXIa + rate_r4_ + rate_r5_)/compartment_1;
        rate_dFg = compartment_1*d_Fg*(x_values[9]/compartment_1);
        RATE_OF_compartment_1_FDP = (rate_dF - rate_dFDP + rate_dFg + rate_r15 + rate_r17)/compartment_1;
        RATE_OF_compartment_1_Fg = (-rate_dFg + rate_pFg - rate_r14 - rate_r15)/compartment_1;
        rate_r1_ = compartment_1*Hyperbolic_rate_law(r1__v, x_values[30]/compartment_1, x_values[11]/compartment_1, r1__k);
        RATE_OF_compartment_1_VIII = (-rate_dVIII + rate_pVIII - rate_r1_)/compartment_1;
        rate_dVII = compartment_1*d_VII*(x_values[29]/compartment_1);
        x_values[16] = 0.0;
        rate_eHeparinIXa = compartment_1*Heparin_ke*(x_values[16]/compartment_1);
        RATE_OF_compartment_1_IXa_ATIII_Heparin = (-rate_eHeparinIXa + rate_r46)/compartment_1;
        rate_r34 = compartment_1*Hyperbolic_rate_law(r34_v, x_values[42]/compartment_1, x_values[34]/compartment_1, r34_k);
        rate_r35 = compartment_1*Hyperbolic_rate_law(r35_v, x_values[14]/compartment_1, x_values[34]/compartment_1, r35_k);
        rate_dXI = compartment_1*dXI_k1*(x_values[44]/compartment_1);
        RATE_OF_compartment_1_XI = (-rate_dXI + rate_pXI - rate_r4_ - rate_r5_)/compartment_1;
        rate_r36 = compartment_1*Hyperbolic_rate_law(r36_v, x_values[32]/compartment_1, x_values[25]/compartment_1, r36_k);
        rate_dAPC = compartment_1*dAPC_k1*(x_values[0]/compartment_1);
        rate_r37 = compartment_1*Irreversible_association(x_values[0]/compartment_1, x_values[21]/compartment_1, r37_c);
        RATE_OF_compartment_1_APC_PS = (-rate_dAPC_PS + rate_r37)/compartment_1;
        RATE_OF_compartment_1_PS = (-rate_dPS + rate_pPS_VKH2 - rate_r37)/compartment_1;
        RATE_OF_compartment_1_VKH2 = (-rate_dVKH2 + rate_r47)/compartment_1;
        rate_r30 = compartment_1*Irreversible_association(x_values[29]/compartment_1, x_values[25]/compartment_1, r30_c);
        rate_r31 = compartment_1*Irreversible_association(x_values[34]/compartment_1, x_values[52]/compartment_1, r31_c);
        RATE_OF_compartment_1_VIIa_TF_Xa_TFPI = (-rate_dVIIa_TF_Xa_TFPI + rate_r31)/compartment_1;
        rate_r32 = compartment_1*Irreversible_association(x_values[50]/compartment_1, x_values[26]/compartment_1, r32_c);
        RATE_OF_compartment_1_Xa_TFPI = (-rate_dXa_TFPI - rate_r31 + rate_r32)/compartment_1;
        RATE_OF_compartment_1_TFPI = (-rate_dTFPI + rate_pTFPI - rate_r32)/compartment_1;
        rate_r33 = compartment_1*Hyperbolic_rate_law(r33_v, x_values[32]/compartment_1, x_values[50]/compartment_1, r33_k);
        rate_dXF = compartment_1*dXF_k1*(x_values[43]/compartment_1);
        rate_r38 = compartment_1*Hyperbolic_rate_law(r38_v, x_values[29]/compartment_1, x_values[50]/compartment_1, r38_k);
        rate_r39 = compartment_1*Hyperbolic_rate_law(r39_v, x_values[29]/compartment_1, x_values[34]/compartment_1, r39_k);
        RATE_OF_compartment_1_VII = (-rate_dVII + rate_pVII_VKH2 - rate_r30 - rate_r38 - rate_r39 - rate_r40 - rate_r6_)/compartment_1;
        rate_dVIIa_TF = compartment_1*dVIIa_TF_k1*(x_values[34]/compartment_1);
        rate_pXII = compartment_1*Factor_production(XII0, d_XII);
        x_values[4] = 0.0;
        rate_r41 = compartment_1*sep(r41_v, x_values[45]/compartment_1, x_values[4]/compartment_1, r41_k);
        rate_dCA = compartment_1*dCA_k1*(x_values[4]/compartment_1);
        RATE_OF_compartment_1_CA = -rate_dCA/compartment_1;
        RATE_OF_compartment_1_XIIa = (-rate_dXIIa + rate_r41 + rate_r42)/compartment_1;
        RATE_OF_compartment_1_XII = (-rate_dXII + rate_pXII - rate_r41 - rate_r42)/compartment_1;
        RATE_OF_compartment_1_V = (-rate_dV + rate_pV - rate_r10)/compartment_1;
        rate_pTmod = compartment_1*Factor_production(Tmod0, d_Tmod);
        RATE_OF_compartment_1_X = (-rate_dX + rate_pX_VKH2 - rate_r34 - rate_r7_ - rate_r8_ - rate_r9_)/compartment_1;
        rate_dVII_TF = compartment_1*dVII_TF_k1*(x_values[32]/compartment_1);
        RATE_OF_compartment_1_VII_TF = (-rate_dVII_TF + rate_r30 - rate_r33 - rate_r36)/compartment_1;
        RATE_OF_compartment_1_II = (-rate_dII + rate_pII_VKH2 - rate_r12 - rate_r13)/compartment_1;
        rate_r23 = compartment_1*Hyperbolic_rate_law(r23_v, x_values[22]/compartment_1, x_values[1]/compartment_1, r23_k);
        rate_r24 = compartment_1*Hyperbolic_rate_law(r24_v, x_values[20]/compartment_1, x_values[13]/compartment_1, r24_k);
        RATE_OF_compartment_1_PC = (-rate_dPC + rate_pPC_VKH2 - rate_r24)/compartment_1;
        RATE_OF_compartment_1_APC = (-rate_dAPC + rate_r24 - rate_r37)/compartment_1;
        rate_r25 = compartment_1*Hyperbolic_rate_law(r25_v, x_values[41]/compartment_1, x_values[1]/compartment_1, r25_k);
        rate_r26 = compartment_1*Irreversible_association(x_values[15]/compartment_1, x_values[31]/compartment_1, r26_c);
        RATE_OF_compartment_1_IXa_VIIIa = (-rate_dIXa_VIIIa + rate_r26)/compartment_1;
        RATE_OF_compartment_1_VIIIa = (-rate_dVIIIa + rate_r1_ - rate_r26 - rate_r2_)/compartment_1;
        RATE_OF_compartment_1_IXa = (-rate_dIXa - rate_r26 + rate_r35 + rate_r3_ - rate_r46)/compartment_1;
        rate_dVa = compartment_1*dVa_k1*(x_values[40]/compartment_1);
        rate_r20 = compartment_1*Hyperbolic_rate_law(r20_v, x_values[46]/compartment_1, x_values[11]/compartment_1, r20_k);
        RATE_OF_compartment_1_XIII = (-rate_dXIII + rate_pXIII - rate_r20)/compartment_1;
        x_values[27] = Tmod0*compartment_1;
        rate_dTmod = compartment_1*d_Tmod*(x_values[27]/compartment_1);
        rate_r21 = compartment_1*Hyperbolic_rate_law(r21_v, x_values[22]/compartment_1, x_values[11]/compartment_1, r21_k);
        RATE_OF_compartment_1_IIa_ATIII_Heparin = (-rate_eHeparinIIa + rate_r44)/compartment_1;
        rate_r22 = compartment_1*Hyperbolic_rate_law(r22_v, x_values[22]/compartment_1, x_values[7]/compartment_1, r22_k);
        RATE_OF_compartment_1_Pg = (-rate_dPg + rate_pPg - rate_r21 - rate_r22 - rate_r23)/compartment_1;
        RATE_OF_compartment_1_P = (-rate_dP + rate_r21 + rate_r22 + rate_r23)/compartment_1;
        x_values[47] = 0.0;
        rate_dXIIIa = compartment_1*dXIIIa_k1*(x_values[47]/compartment_1);
        RATE_OF_compartment_1_XIIIa = (-rate_dXIIIa + rate_r20)/compartment_1;
        rate_r16 = compartment_1*Hyperbolic_rate_law(r16_v, x_values[7]/compartment_1, x_values[47]/compartment_1, r16_k);
        RATE_OF_compartment_1_XF = (-rate_dXF + rate_r16 - rate_r18 - rate_r19)/compartment_1;
        RATE_OF_compartment_1_D = (-rate_dD + rate_dXF + rate_r18 + rate_r19)/compartment_1;
        RATE_OF_compartment_1_IX = (-rate_dIX + rate_pIX_VKH2 - rate_r35 - rate_r3_)/compartment_1;
        RATE_OF_compartment_1_F = (-rate_dF + rate_r14 - rate_r16 - rate_r17)/compartment_1;
        rate_r27 = compartment_1*Irreversible_association(x_values[40]/compartment_1, x_values[50]/compartment_1, r27_c);
        RATE_OF_compartment_1_Va = (-rate_dVa + rate_r10 - rate_r11 - rate_r27)/compartment_1;
        RATE_OF_compartment_1_Va_Xa = (-rate_dVa_Xa - rate_r25 + rate_r27)/compartment_1;
        RATE_OF_compartment_1_Xa = (-rate_dXa - rate_r27 - rate_r32 + rate_r34 - rate_r45 + rate_r7_ + rate_r8_ + rate_r9_)/compartment_1;
        rate_r28 = compartment_1*Irreversible_association(x_values[11]/compartment_1, x_values[27]/compartment_1, r28_c);
        RATE_OF_compartment_1_Tmod = (-rate_dTmod + rate_pTmod - rate_r28)/compartment_1;
        RATE_OF_compartment_1_IIa = (-rate_dIIa + rate_r12 + rate_r13 - rate_r28 - rate_r44)/compartment_1;
        RATE_OF_compartment_1_IIa_Tmod = (-rate_dIIa_Tmod + rate_r28)/compartment_1;
        rate_r29 = compartment_1*Irreversible_association(x_values[33]/compartment_1, x_values[25]/compartment_1, r29_c);
        RATE_OF_compartment_1_VIIa = (-rate_dVIIa - rate_r29 + rate_r38 + rate_r39 + rate_r40 + rate_r6_)/compartment_1;
        RATE_OF_compartment_1_TF = (-rate_dTF - rate_r29 - rate_r30)/compartment_1;
        RATE_OF_compartment_1_VIIa_TF = (-rate_dVIIa_TF + rate_r29 - rate_r31 + rate_r33 + rate_r36)/compartment_1;
        RATE_OF_compartment_1_K = (-rate_dK + rate_r43)/compartment_1;
    }
    protected double Factor_production(double initial, double degradation)
    {
         return initial*degradation;
    }

    protected double Hyperbolic_rate_law(double v, double substrate, double enzyme, double k)
    {
         return v*substrate*enzyme/(k + enzyme);
    }

    protected double Irreversible_association(double s1, double s2, double c)
    {
         return s1*s2/c;
    }

    protected double VKH2mediated_factor_production(double d_factor, double factor_initial, double VKH2, double VKH2_initial)
    {
         return d_factor*factor_initial*VKH2/VKH2_initial;
    }

    protected double Warfarin_inhibited_first_order_kinetics(double Imax, double Cwarf, double IC50, double substrate, double degradation)
    {
         return degradation*substrate*(1.0 - Imax*Cwarf/(IC50 + Cwarf));
    }

    protected double sep(double v, double substrate, double enzyme, double k)
    {
         return v*substrate*enzyme/(k + enzyme);
    }


 

    public final double[] dy_dt_slow(double time, double[] x_values) throws Exception
    {
        this.time = time;
        this.x_values = x_values;
        final double[] dydt = new double[54];
        calculateParameters();
        calculateReactionRates();
        dydt[0] = -rate_dAPC+rate_r24-rate_r37;  //  rate rule for of $compartment_1.APC
        dydt[1] = -rate_dAPC_PS+rate_r37;  //  rate rule for of $compartment_1.APC_PS
        dydt[2] = -rate_eHeparin-rate_r44-rate_r45-rate_r46;  //  rate rule for of $compartment_1.ATIII_Heparin
        dydt[3] = -Warfarin_ka*(x_values[3]/compartment_1)*compartment_1;  //  rate rule for of $compartment_1.A_warf
        dydt[4] = -rate_dCA;  //  rate rule for of $compartment_1.CA
        dydt[5] = +(Warfarin_ka*(x_values[3]/compartment_1)/Warfarin_Vd - Warfarin_ke*(x_values[5]/compartment_1))*compartment_1;  //  rate rule for of $compartment_1.C_warf
        dydt[6] = -rate_dD+rate_dXF+rate_r18+rate_r19;  //  rate rule for of $compartment_1.D
        dydt[7] = -rate_dF+rate_r14-rate_r16-rate_r17;  //  rate rule for of $compartment_1.F
        dydt[8] = +rate_dF-rate_dFDP+rate_dFg+rate_r15+rate_r17;  //  rate rule for of $compartment_1.FDP
        dydt[9] = -rate_dFg+rate_pFg-rate_r14-rate_r15;  //  rate rule for of $compartment_1.Fg
        dydt[10] = -rate_dII+rate_pII_VKH2-rate_r12-rate_r13;  //  rate rule for of $compartment_1.II
        dydt[11] = -rate_dIIa+rate_r12+rate_r13-rate_r28-rate_r44;  //  rate rule for of $compartment_1.IIa
        dydt[12] = -rate_eHeparinIIa+rate_r44;  //  rate rule for of $compartment_1.IIa_ATIII_Heparin
        dydt[13] = -rate_dIIa_Tmod+rate_r28;  //  rate rule for of $compartment_1.IIa_Tmod
        dydt[14] = -rate_dIX+rate_pIX_VKH2-rate_r35-rate_r3_;  //  rate rule for of $compartment_1.IX
        dydt[15] = -rate_dIXa-rate_r26+rate_r35+rate_r3_-rate_r46;  //  rate rule for of $compartment_1.IXa
        dydt[16] = -rate_eHeparinIXa+rate_r46;  //  rate rule for of $compartment_1.IXa_ATIII_Heparin
        dydt[17] = -rate_dIXa_VIIIa+rate_r26;  //  rate rule for of $compartment_1.IXa_VIIIa
        dydt[18] = -rate_dK+rate_r43;  //  rate rule for of $compartment_1.K
        dydt[19] = -rate_dP+rate_r21+rate_r22+rate_r23;  //  rate rule for of $compartment_1.P
        dydt[20] = -rate_dPC+rate_pPC_VKH2-rate_r24;  //  rate rule for of $compartment_1.PC
        dydt[21] = -rate_dPS+rate_pPS_VKH2-rate_r37;  //  rate rule for of $compartment_1.PS
        dydt[22] = -rate_dPg+rate_pPg-rate_r21-rate_r22-rate_r23;  //  rate rule for of $compartment_1.Pg
        dydt[23] = -rate_dPk+rate_pPk-rate_r43;  //  rate rule for of $compartment_1.Pk
        dydt[24] = +rate_dIIa-rate_dTAT;  //  rate rule for of $compartment_1.TAT
        dydt[25] = -rate_dTF-rate_r29-rate_r30;  //  rate rule for of $compartment_1.TF
        dydt[26] = -rate_dTFPI+rate_pTFPI-rate_r32;  //  rate rule for of $compartment_1.TFPI
        dydt[27] = -rate_dTmod+rate_pTmod-rate_r28;  //  rate rule for of $compartment_1.Tmod
        dydt[28] = -rate_dV+rate_pV-rate_r10;  //  rate rule for of $compartment_1.V
        dydt[29] = -rate_dVII+rate_pVII_VKH2-rate_r30-rate_r38-rate_r39-rate_r40-rate_r6_;  //  rate rule for of $compartment_1.VII
        dydt[30] = -rate_dVIII+rate_pVIII-rate_r1_;  //  rate rule for of $compartment_1.VIII
        dydt[31] = -rate_dVIIIa+rate_r1_-rate_r26-rate_r2_;  //  rate rule for of $compartment_1.VIIIa
        dydt[32] = -rate_dVII_TF+rate_r30-rate_r33-rate_r36;  //  rate rule for of $compartment_1.VII_TF
        dydt[33] = -rate_dVIIa-rate_r29+rate_r38+rate_r39+rate_r40+rate_r6_;  //  rate rule for of $compartment_1.VIIa
        dydt[34] = -rate_dVIIa_TF+rate_r29-rate_r31+rate_r33+rate_r36;  //  rate rule for of $compartment_1.VIIa_TF
        dydt[35] = -rate_dVIIa_TF_Xa_TFPI+rate_r31;  //  rate rule for of $compartment_1.VIIa_TF_Xa_TFPI
        dydt[36] = -rate_VK_transport-rate_dVK+rate_pVK-rate_r47+rate_r48;  //  rate rule for of $compartment_1.VK
        dydt[37] = -rate_dVKH2+rate_r47;  //  rate rule for of $compartment_1.VKH2
        dydt[38] = +rate_dVKH2-rate_r48;  //  rate rule for of $compartment_1.VKO
        dydt[39] = +rate_VK_transport;  //  rate rule for of $compartment_1.VK_p
        dydt[40] = -rate_dVa+rate_r10-rate_r11-rate_r27;  //  rate rule for of $compartment_1.Va
        dydt[41] = -rate_dVa_Xa-rate_r25+rate_r27;  //  rate rule for of $compartment_1.Va_Xa
        dydt[42] = -rate_dX+rate_pX_VKH2-rate_r34-rate_r7_-rate_r8_-rate_r9_;  //  rate rule for of $compartment_1.X
        dydt[43] = -rate_dXF+rate_r16-rate_r18-rate_r19;  //  rate rule for of $compartment_1.XF
        dydt[44] = -rate_dXI+rate_pXI-rate_r4_-rate_r5_;  //  rate rule for of $compartment_1.XI
        dydt[45] = -rate_dXII+rate_pXII-rate_r41-rate_r42;  //  rate rule for of $compartment_1.XII
        dydt[46] = -rate_dXIII+rate_pXIII-rate_r20;  //  rate rule for of $compartment_1.XIII
        dydt[47] = -rate_dXIIIa+rate_r20;  //  rate rule for of $compartment_1.XIIIa
        dydt[48] = -rate_dXIIa+rate_r41+rate_r42;  //  rate rule for of $compartment_1.XIIa
        dydt[49] = -rate_dXIa+rate_r4_+rate_r5_;  //  rate rule for of $compartment_1.XIa
        dydt[50] = -rate_dXa-rate_r27-rate_r32+rate_r34-rate_r45+rate_r7_+rate_r8_+rate_r9_;  //  rate rule for of $compartment_1.Xa
        dydt[51] = -rate_eHeparinXa+rate_r45;  //  rate rule for of $compartment_1.Xa_ATIII_Heparin
        dydt[52] = -rate_dXa_TFPI-rate_r31+rate_r32;  //  rate rule for of $compartment_1.Xa_TFPI
        dydt[53] = +x_values[7]/compartment_1;  //  rate rule for of Integral_Fibrin
        return dydt;
    }





    @Override
    public final void init() throws Exception
    {
        CONSTRAINTS__VIOLATED = 0;
        rate_VK_transport = 0.0; // initial value of $$rate_VK_transport
        rate_dAPC = 0.0; // initial value of $$rate_dAPC
        rate_dAPC_PS = 0.0; // initial value of $$rate_dAPC_PS
        rate_dCA = 0.0; // initial value of $$rate_dCA
        rate_dD = 0.0; // initial value of $$rate_dD
        rate_dF = 0.0; // initial value of $$rate_dF
        rate_dFDP = 0.0; // initial value of $$rate_dFDP
        rate_dFg = 0.0; // initial value of $$rate_dFg
        rate_dII = 0.0; // initial value of $$rate_dII
        rate_dIIa = 0.0; // initial value of $$rate_dIIa
        rate_dIIa_Tmod = 0.0; // initial value of $$rate_dIIa_Tmod
        rate_dIX = 0.0; // initial value of $$rate_dIX
        rate_dIXa = 0.0; // initial value of $$rate_dIXa
        rate_dIXa_VIIIa = 0.0; // initial value of $$rate_dIXa_VIIIa
        rate_dK = 0.0; // initial value of $$rate_dK
        rate_dP = 0.0; // initial value of $$rate_dP
        rate_dPC = 0.0; // initial value of $$rate_dPC
        rate_dPS = 0.0; // initial value of $$rate_dPS
        rate_dPg = 0.0; // initial value of $$rate_dPg
        rate_dPk = 0.0; // initial value of $$rate_dPk
        rate_dTAT = 0.0; // initial value of $$rate_dTAT
        rate_dTF = 0.0; // initial value of $$rate_dTF
        rate_dTFPI = 0.0; // initial value of $$rate_dTFPI
        rate_dTmod = 0.0; // initial value of $$rate_dTmod
        rate_dV = 0.0; // initial value of $$rate_dV
        rate_dVII = 0.0; // initial value of $$rate_dVII
        rate_dVIII = 0.0; // initial value of $$rate_dVIII
        rate_dVIIIa = 0.0; // initial value of $$rate_dVIIIa
        rate_dVII_TF = 0.0; // initial value of $$rate_dVII_TF
        rate_dVIIa = 0.0; // initial value of $$rate_dVIIa
        rate_dVIIa_TF = 0.0; // initial value of $$rate_dVIIa_TF
        rate_dVIIa_TF_Xa_TFPI = 0.0; // initial value of $$rate_dVIIa_TF_Xa_TFPI
        rate_dVK = 0.0; // initial value of $$rate_dVK
        rate_dVKH2 = 0.0; // initial value of $$rate_dVKH2
        rate_dVa = 0.0; // initial value of $$rate_dVa
        rate_dVa_Xa = 0.0; // initial value of $$rate_dVa_Xa
        rate_dX = 0.0; // initial value of $$rate_dX
        rate_dXF = 0.0; // initial value of $$rate_dXF
        rate_dXI = 0.0; // initial value of $$rate_dXI
        rate_dXII = 0.0; // initial value of $$rate_dXII
        rate_dXIII = 0.0; // initial value of $$rate_dXIII
        rate_dXIIIa = 0.0; // initial value of $$rate_dXIIIa
        rate_dXIIa = 0.0; // initial value of $$rate_dXIIa
        rate_dXIa = 0.0; // initial value of $$rate_dXIa
        rate_dXa = 0.0; // initial value of $$rate_dXa
        rate_dXa_TFPI = 0.0; // initial value of $$rate_dXa_TFPI
        rate_eHeparin = 0.0; // initial value of $$rate_eHeparin
        rate_eHeparinIIa = 0.0; // initial value of $$rate_eHeparinIIa
        rate_eHeparinIXa = 0.0; // initial value of $$rate_eHeparinIXa
        rate_eHeparinXa = 0.0; // initial value of $$rate_eHeparinXa
        rate_pFg = 0.0; // initial value of $$rate_pFg
        rate_pII_VKH2 = 0.0; // initial value of $$rate_pII_VKH2
        rate_pIX_VKH2 = 0.0; // initial value of $$rate_pIX_VKH2
        rate_pPC_VKH2 = 0.0; // initial value of $$rate_pPC_VKH2
        rate_pPS_VKH2 = 0.0; // initial value of $$rate_pPS_VKH2
        rate_pPg = 0.0; // initial value of $$rate_pPg
        rate_pPk = 0.0; // initial value of $$rate_pPk
        rate_pTFPI = 0.0; // initial value of $$rate_pTFPI
        rate_pTmod = 0.0; // initial value of $$rate_pTmod
        rate_pV = 0.0; // initial value of $$rate_pV
        rate_pVIII = 0.0; // initial value of $$rate_pVIII
        rate_pVII_VKH2 = 0.0; // initial value of $$rate_pVII_VKH2
        rate_pVK = 0.0; // initial value of $$rate_pVK
        rate_pXI = 0.0; // initial value of $$rate_pXI
        rate_pXII = 0.0; // initial value of $$rate_pXII
        rate_pXIII = 0.0; // initial value of $$rate_pXIII
        rate_pX_VKH2 = 0.0; // initial value of $$rate_pX_VKH2
        rate_r10 = 0.0; // initial value of $$rate_r10
        rate_r11 = 0.0; // initial value of $$rate_r11
        rate_r12 = 0.0; // initial value of $$rate_r12
        rate_r13 = 0.0; // initial value of $$rate_r13
        rate_r14 = 0.0; // initial value of $$rate_r14
        rate_r15 = 0.0; // initial value of $$rate_r15
        rate_r16 = 0.0; // initial value of $$rate_r16
        rate_r17 = 0.0; // initial value of $$rate_r17
        rate_r18 = 0.0; // initial value of $$rate_r18
        rate_r19 = 0.0; // initial value of $$rate_r19
        rate_r1_ = 0.0; // initial value of $$rate_r1_
        rate_r20 = 0.0; // initial value of $$rate_r20
        rate_r21 = 0.0; // initial value of $$rate_r21
        rate_r22 = 0.0; // initial value of $$rate_r22
        rate_r23 = 0.0; // initial value of $$rate_r23
        rate_r24 = 0.0; // initial value of $$rate_r24
        rate_r25 = 0.0; // initial value of $$rate_r25
        rate_r26 = 0.0; // initial value of $$rate_r26
        rate_r27 = 0.0; // initial value of $$rate_r27
        rate_r28 = 0.0; // initial value of $$rate_r28
        rate_r29 = 0.0; // initial value of $$rate_r29
        rate_r2_ = 0.0; // initial value of $$rate_r2_
        rate_r30 = 0.0; // initial value of $$rate_r30
        rate_r31 = 0.0; // initial value of $$rate_r31
        rate_r32 = 0.0; // initial value of $$rate_r32
        rate_r33 = 0.0; // initial value of $$rate_r33
        rate_r34 = 0.0; // initial value of $$rate_r34
        rate_r35 = 0.0; // initial value of $$rate_r35
        rate_r36 = 0.0; // initial value of $$rate_r36
        rate_r37 = 0.0; // initial value of $$rate_r37
        rate_r38 = 0.0; // initial value of $$rate_r38
        rate_r39 = 0.0; // initial value of $$rate_r39
        rate_r3_ = 0.0; // initial value of $$rate_r3_
        rate_r40 = 0.0; // initial value of $$rate_r40
        rate_r41 = 0.0; // initial value of $$rate_r41
        rate_r42 = 0.0; // initial value of $$rate_r42
        rate_r43 = 0.0; // initial value of $$rate_r43
        rate_r44 = 0.0; // initial value of $$rate_r44
        rate_r45 = 0.0; // initial value of $$rate_r45
        rate_r46 = 0.0; // initial value of $$rate_r46
        rate_r47 = 0.0; // initial value of $$rate_r47
        rate_r48 = 0.0; // initial value of $$rate_r48
        rate_r4_ = 0.0; // initial value of $$rate_r4_
        rate_r5_ = 0.0; // initial value of $$rate_r5_
        rate_r6_ = 0.0; // initial value of $$rate_r6_
        rate_r7_ = 0.0; // initial value of $$rate_r7_
        rate_r8_ = 0.0; // initial value of $$rate_r8_
        rate_r9_ = 0.0; // initial value of $$rate_r9_
        compartment_1 = 1.0; // initial value of $compartment_1
        compartment_1_DP = 0.0; // initial value of $compartment_1.DP
        Fg0 = 8945.5; // initial value of Fg0
        Heparin_ke = 0.693; // initial value of Heparin_ke
        IC50 = 0.34; // initial value of IC50
        II0 = 1394.4; // initial value of II0
        IX0 = 89.6; // initial value of IX0
        I_max = 1.0; // initial value of I_max
        PC0 = 60.0; // initial value of PC0
        PS0 = 300.0; // initial value of PS0
        Pg0 = 2154.3; // initial value of Pg0
        Pk0 = 450.0; // initial value of Pk0
        R1 = 0.140845070422535; // initial value of R1
        R2 = 1.0; // initial value of R2
        RATE_OF_Integral_Fibrin = 0.0; // initial value of RATE_OF_Integral_Fibrin
        RATE_OF_compartment_1_APC = 0.0; // initial value of RATE_OF_compartment_1_APC
        RATE_OF_compartment_1_APC_PS = 0.0; // initial value of RATE_OF_compartment_1_APC_PS
        RATE_OF_compartment_1_ATIII_Heparin = 0.0; // initial value of RATE_OF_compartment_1_ATIII_Heparin
        RATE_OF_compartment_1_A_warf = 0.0; // initial value of RATE_OF_compartment_1_A_warf
        RATE_OF_compartment_1_CA = 0.0; // initial value of RATE_OF_compartment_1_CA
        RATE_OF_compartment_1_C_warf = 0.0; // initial value of RATE_OF_compartment_1_C_warf
        RATE_OF_compartment_1_D = 0.0; // initial value of RATE_OF_compartment_1_D
        RATE_OF_compartment_1_F = 0.0; // initial value of RATE_OF_compartment_1_F
        RATE_OF_compartment_1_FDP = 0.0; // initial value of RATE_OF_compartment_1_FDP
        RATE_OF_compartment_1_Fg = 0.0; // initial value of RATE_OF_compartment_1_Fg
        RATE_OF_compartment_1_II = 0.0; // initial value of RATE_OF_compartment_1_II
        RATE_OF_compartment_1_IIa = 0.0; // initial value of RATE_OF_compartment_1_IIa
        RATE_OF_compartment_1_IIa_ATIII_Heparin = 0.0; // initial value of RATE_OF_compartment_1_IIa_ATIII_Heparin
        RATE_OF_compartment_1_IIa_Tmod = 0.0; // initial value of RATE_OF_compartment_1_IIa_Tmod
        RATE_OF_compartment_1_IX = 0.0; // initial value of RATE_OF_compartment_1_IX
        RATE_OF_compartment_1_IXa = 0.0; // initial value of RATE_OF_compartment_1_IXa
        RATE_OF_compartment_1_IXa_ATIII_Heparin = 0.0; // initial value of RATE_OF_compartment_1_IXa_ATIII_Heparin
        RATE_OF_compartment_1_IXa_VIIIa = 0.0; // initial value of RATE_OF_compartment_1_IXa_VIIIa
        RATE_OF_compartment_1_K = 0.0; // initial value of RATE_OF_compartment_1_K
        RATE_OF_compartment_1_P = 0.0; // initial value of RATE_OF_compartment_1_P
        RATE_OF_compartment_1_PC = 0.0; // initial value of RATE_OF_compartment_1_PC
        RATE_OF_compartment_1_PS = 0.0; // initial value of RATE_OF_compartment_1_PS
        RATE_OF_compartment_1_Pg = 0.0; // initial value of RATE_OF_compartment_1_Pg
        RATE_OF_compartment_1_Pk = 0.0; // initial value of RATE_OF_compartment_1_Pk
        RATE_OF_compartment_1_TAT = 0.0; // initial value of RATE_OF_compartment_1_TAT
        RATE_OF_compartment_1_TF = 0.0; // initial value of RATE_OF_compartment_1_TF
        RATE_OF_compartment_1_TFPI = 0.0; // initial value of RATE_OF_compartment_1_TFPI
        RATE_OF_compartment_1_Tmod = 0.0; // initial value of RATE_OF_compartment_1_Tmod
        RATE_OF_compartment_1_V = 0.0; // initial value of RATE_OF_compartment_1_V
        RATE_OF_compartment_1_VII = 0.0; // initial value of RATE_OF_compartment_1_VII
        RATE_OF_compartment_1_VIII = 0.0; // initial value of RATE_OF_compartment_1_VIII
        RATE_OF_compartment_1_VIIIa = 0.0; // initial value of RATE_OF_compartment_1_VIIIa
        RATE_OF_compartment_1_VII_TF = 0.0; // initial value of RATE_OF_compartment_1_VII_TF
        RATE_OF_compartment_1_VIIa = 0.0; // initial value of RATE_OF_compartment_1_VIIa
        RATE_OF_compartment_1_VIIa_TF = 0.0; // initial value of RATE_OF_compartment_1_VIIa_TF
        RATE_OF_compartment_1_VIIa_TF_Xa_TFPI = 0.0; // initial value of RATE_OF_compartment_1_VIIa_TF_Xa_TFPI
        RATE_OF_compartment_1_VK = 0.0; // initial value of RATE_OF_compartment_1_VK
        RATE_OF_compartment_1_VKH2 = 0.0; // initial value of RATE_OF_compartment_1_VKH2
        RATE_OF_compartment_1_VKO = 0.0; // initial value of RATE_OF_compartment_1_VKO
        RATE_OF_compartment_1_VK_p = 0.0; // initial value of RATE_OF_compartment_1_VK_p
        RATE_OF_compartment_1_Va = 0.0; // initial value of RATE_OF_compartment_1_Va
        RATE_OF_compartment_1_Va_Xa = 0.0; // initial value of RATE_OF_compartment_1_Va_Xa
        RATE_OF_compartment_1_X = 0.0; // initial value of RATE_OF_compartment_1_X
        RATE_OF_compartment_1_XF = 0.0; // initial value of RATE_OF_compartment_1_XF
        RATE_OF_compartment_1_XI = 0.0; // initial value of RATE_OF_compartment_1_XI
        RATE_OF_compartment_1_XII = 0.0; // initial value of RATE_OF_compartment_1_XII
        RATE_OF_compartment_1_XIII = 0.0; // initial value of RATE_OF_compartment_1_XIII
        RATE_OF_compartment_1_XIIIa = 0.0; // initial value of RATE_OF_compartment_1_XIIIa
        RATE_OF_compartment_1_XIIa = 0.0; // initial value of RATE_OF_compartment_1_XIIa
        RATE_OF_compartment_1_XIa = 0.0; // initial value of RATE_OF_compartment_1_XIa
        RATE_OF_compartment_1_Xa = 0.0; // initial value of RATE_OF_compartment_1_Xa
        RATE_OF_compartment_1_Xa_ATIII_Heparin = 0.0; // initial value of RATE_OF_compartment_1_Xa_ATIII_Heparin
        RATE_OF_compartment_1_Xa_TFPI = 0.0; // initial value of RATE_OF_compartment_1_Xa_TFPI
        TFPI0 = 2.5; // initial value of TFPI0
        Tmod0 = 50.0; // initial value of Tmod0
        V0 = 26.7; // initial value of V0
        VII0 = 10.0; // initial value of VII0
        VIII0 = 0.7; // initial value of VIII0
        VK0 = 1.0; // initial value of VK0
        VKH20 = 0.1; // initial value of VKH20
        VKO0 = 0.1; // initial value of VKO0
        VitaminK_Vc = 24.0; // initial value of VitaminK_Vc
        VitaminK_k12 = 0.0587; // initial value of VitaminK_k12
        VitaminK_k21_Vc = 5.08333333333333E-4; // initial value of VitaminK_k21_Vc
        Warfarin_CL = 0.2; // initial value of Warfarin_CL
        Warfarin_Vd = 10.0; // initial value of Warfarin_Vd
        Warfarin_ka = 1.0; // initial value of Warfarin_ka
        Warfarin_ke = 0.02; // initial value of Warfarin_ke
        X0 = 174.3; // initial value of X0
        XI0 = 30.6; // initial value of XI0
        XII0 = 375.0; // initial value of XII0
        XIII0 = 70.3; // initial value of XIII0
        assignment = 0.0; // initial value of assignment
        c44 = 0.119718309859155; // initial value of c44
        c45 = 0.85; // initial value of c45
        c46 = 0.85; // initial value of c46
        clottingTime_s = 0.0; // initial value of clottingTime_s
        dAPC_PS_k1 = 20.0; // initial value of dAPC_PS_k1
        dAPC_k1 = 20.4; // initial value of dAPC_k1
        dCA_k1 = 0.05; // initial value of dCA_k1
        dD_k1 = 0.1; // initial value of dD_k1
        dFDP_k1 = 3.5; // initial value of dFDP_k1
        dF_k1 = 0.05; // initial value of dF_k1
        dIIa_Tmod_k1 = 20.0; // initial value of dIIa_Tmod_k1
        dIIa_k1 = 67.4; // initial value of dIIa_k1
        dIXa_VIIIa_k1 = 20.0; // initial value of dIXa_VIIIa_k1
        dIXa_k1 = 20.0; // initial value of dIXa_k1
        dK_k1 = 20.0; // initial value of dK_k1
        dP_k1 = 20.0; // initial value of dP_k1
        dTAT_k1 = 0.2; // initial value of dTAT_k1
        dTF_k1 = 0.05; // initial value of dTF_k1
        dVIIIa_k1 = 20.0; // initial value of dVIIIa_k1
        dVII_TF_k1 = 0.7; // initial value of dVII_TF_k1
        dVIIa_TF_Xa_TFPI_k1 = 20.0; // initial value of dVIIa_TF_Xa_TFPI_k1
        dVIIa_TF_k1 = 20.0; // initial value of dVIIa_TF_k1
        dVIIa_k1 = 20.0; // initial value of dVIIa_k1
        dVa_Xa_k1 = 20.0; // initial value of dVa_Xa_k1
        dVa_k1 = 20.0; // initial value of dVa_k1
        dXF_k1 = 0.05; // initial value of dXF_k1
        dXIIIa_k1 = 0.69; // initial value of dXIIIa_k1
        dXIIa_k1 = 20.0; // initial value of dXIIa_k1
        dXI_k1 = 0.1; // initial value of dXI_k1
        dXIa_k1 = 20.0; // initial value of dXIa_k1
        dXa_TFPI_k1 = 20.0; // initial value of dXa_TFPI_k1
        dXa_k1 = 20.0; // initial value of dXa_k1
        d_Fg = 0.032; // initial value of d_Fg
        d_II = 0.01; // initial value of d_II
        d_IX = 0.029; // initial value of d_IX
        d_PC = 0.05; // initial value of d_PC
        d_PS = 0.0165; // initial value of d_PS
        d_Pg = 0.05; // initial value of d_Pg
        d_Pk = 0.05; // initial value of d_Pk
        d_TFPI = 20.0; // initial value of d_TFPI
        d_Tmod = 0.05; // initial value of d_Tmod
        d_V = 0.043; // initial value of d_V
        d_VII = 0.12; // initial value of d_VII
        d_VIII = 0.058; // initial value of d_VIII
        d_VK = 0.2052; // initial value of d_VK
        d_VK2 = 0.0228; // initial value of d_VK2
        d_VKH2 = 0.228; // initial value of d_VKH2
        d_VKO = 0.228; // initial value of d_VKO
        d_X = 0.018; // initial value of d_X
        d_XI = 0.1; // initial value of d_XI
        d_XII = 0.012; // initial value of d_XII
        d_XIII = 0.0036; // initial value of d_XIII
        r10_k = 10.0; // initial value of r10_k
        r10_v = 50000.0; // initial value of r10_v
        r11_k = 1.0; // initial value of r11_k
        r11_v = 50.0; // initial value of r11_v
        r12_k = 10.0; // initial value of r12_k
        r12_v = 100.0; // initial value of r12_v
        r13_k = 500.0; // initial value of r13_k
        r13_v = 9.0; // initial value of r13_v
        r14_k = 0.5; // initial value of r14_k
        r14_v = 20000.0; // initial value of r14_v
        r15_k = 500.0; // initial value of r15_k
        r15_v = 500.0; // initial value of r15_v
        r16_k = 10.0; // initial value of r16_k
        r16_v = 7.0; // initial value of r16_v
        r17_k = 10.0; // initial value of r17_k
        r17_v = 7.0; // initial value of r17_v
        r18_k = 100.0; // initial value of r18_k
        r18_v = 7.0; // initial value of r18_v
        r19_k = 1.0; // initial value of r19_k
        r19_v = 1.0; // initial value of r19_v
        r1__k = 1.0E-6; // initial value of r1__k
        r1__v = 50000.0; // initial value of r1__v
        r20_k = 1.0; // initial value of r20_k
        r20_v = 7.0; // initial value of r20_v
        r21_k = 5000.0; // initial value of r21_k
        r21_v = 7.0; // initial value of r21_v
        r22_k = 10000.0; // initial value of r22_k
        r22_v = 5.0; // initial value of r22_v
        r23_k = 1.0; // initial value of r23_k
        r23_v = 2.0; // initial value of r23_v
        r24_k = 1.0; // initial value of r24_k
        r24_v = 7.0; // initial value of r24_v
        r25_k = 1.0; // initial value of r25_k
        r25_v = 2.0; // initial value of r25_v
        r26_c = 0.01; // initial value of r26_c
        r27_c = 0.5; // initial value of r27_c
        r28_c = 0.5; // initial value of r28_c
        r29_c = 0.5; // initial value of r29_c
        r2__k = 1.0; // initial value of r2__k
        r2__v = 50.0; // initial value of r2__v
        r30_c = 0.1; // initial value of r30_c
        r31_c = 0.5; // initial value of r31_c
        r32_c = 0.5; // initial value of r32_c
        r33_k = 1.0; // initial value of r33_k
        r33_v = 70.0; // initial value of r33_v
        r34_k = 200.0; // initial value of r34_k
        r34_v = 900.0; // initial value of r34_v
        r35_k = 1.0; // initial value of r35_k
        r35_v = 70.0; // initial value of r35_v
        r36_k = 1.0; // initial value of r36_k
        r36_v = 1000.0; // initial value of r36_v
        r37_c = 0.5; // initial value of r37_c
        r38_k = 10.0; // initial value of r38_k
        r38_v = 1.0; // initial value of r38_v
        r39_k = 10.0; // initial value of r39_k
        r39_v = 1.0; // initial value of r39_v
        r3__k = 10.0; // initial value of r3__k
        r3__v = 7.0; // initial value of r3__v
        r40_k = 10.0; // initial value of r40_k
        r40_v = 0.2; // initial value of r40_v
        r41_k = 1.0; // initial value of r41_k
        r41_v = 7.0; // initial value of r41_v
        r42_k = 1.0; // initial value of r42_k
        r42_v = 70.0; // initial value of r42_v
        r43_k = 1.0; // initial value of r43_k
        r43_v = 7.0; // initial value of r43_v
        r4__k = 1.0; // initial value of r4__k
        r4__v = 7.0; // initial value of r4__v
        r5__k = 10.0; // initial value of r5__k
        r5__v = 10.0; // initial value of r5__v
        r6__k = 10.0; // initial value of r6__k
        r6__v = 0.1; // initial value of r6__v
        r7__k = 10.0; // initial value of r7__k
        r7__v = 0.02; // initial value of r7__v
        r8__k = 0.1; // initial value of r8__k
        r8__v = 2.0; // initial value of r8__v
        r9__k = 10.0; // initial value of r9__k
        r9__v = 1.0E-9; // initial value of r9__v
        time = 0.0; // initial value of time
        calculateInitialValues();
        this.isInit = true;
    }


    @Override
    public final void init(double[] initialValues, Map<String, Double> parameters) throws Exception
    {
        super.init(initialValues, parameters);
        x_values[30] = VIII0*compartment_1;
        x_values[14] = IX0*compartment_1;
        x_values[49] = XI0*0.148*compartment_1;
        x_values[44] = XI0*0.339*compartment_1;
        x_values[29] = VII0*compartment_1;
        x_values[42] = X0*compartment_1;
        x_values[28] = V0*compartment_1;
        x_values[10] = II0*compartment_1;
        x_values[9] = Fg0*compartment_1;
        x_values[46] = XIII0*compartment_1;
        x_values[22] = Pg0*compartment_1;
        x_values[20] = PC0*compartment_1;
        x_values[27] = Tmod0*compartment_1;
        x_values[26] = TFPI0*compartment_1;
        x_values[21] = PS0*compartment_1;
        x_values[37] = VKH20*compartment_1;
        x_values[45] = XII0*compartment_1;
        x_values[36] = VK0*compartment_1;
        x_values[38] = VKO0*compartment_1;
        x_values[23] = Pk0*compartment_1;
        d_VKH2 = d_VK2*VK0/VKH20;
        d_VKO = d_VK2*VK0/VKO0;
        VitaminK_k21_Vc = 0.0122/VitaminK_Vc;
        Warfarin_ke = Warfarin_CL/Warfarin_Vd;
        c44 = c45*R1;
        c46 = c45*R2;
        this.initialValues = x_values.clone();
    }


    private final void calculateInitialValues() throws Exception
    {
        double[] x_values = this.x_values = new double[54];
        this.time = 0.0;
        x_values[9] = 8945.5; //  initial value of $compartment_1.Fg
        x_values[10] = 1394.4; //  initial value of $compartment_1.II
        x_values[14] = 89.6; //  initial value of $compartment_1.IX
        x_values[20] = 60.0; //  initial value of $compartment_1.PC
        x_values[21] = 300.0; //  initial value of $compartment_1.PS
        x_values[22] = 2154.3; //  initial value of $compartment_1.Pg
        x_values[23] = 450.0; //  initial value of $compartment_1.Pk
        x_values[26] = 2.5; //  initial value of $compartment_1.TFPI
        x_values[27] = 50.0; //  initial value of $compartment_1.Tmod
        x_values[28] = 26.7; //  initial value of $compartment_1.V
        x_values[29] = 10.0; //  initial value of $compartment_1.VII
        x_values[30] = 0.7; //  initial value of $compartment_1.VIII
        x_values[36] = 1.0; //  initial value of $compartment_1.VK
        x_values[37] = 0.1; //  initial value of $compartment_1.VKH2
        x_values[38] = 0.1; //  initial value of $compartment_1.VKO
        x_values[42] = 174.3; //  initial value of $compartment_1.X
        x_values[44] = 10.3734; //  initial value of $compartment_1.XI
        x_values[45] = 375.0; //  initial value of $compartment_1.XII
        x_values[46] = 70.3; //  initial value of $compartment_1.XIII
        x_values[49] = 4.5288; //  initial value of $compartment_1.XIa
        calculateInitialParameters();
        this.initialValues = x_values;
    }




    public final double[] extendResult(double time, double[] x_values) throws Exception
    {
        this.time = time;
        this.x_values = x_values;
        calculateParameters();
        return getCurrentState(); 
    }


    public final double[] getCurrentState()
    {
        return new double[] {
            rate_VK_transport,
            rate_dAPC,
            rate_dAPC_PS,
            rate_dCA,
            rate_dD,
            rate_dF,
            rate_dFDP,
            rate_dFg,
            rate_dII,
            rate_dIIa,
            rate_dIIa_Tmod,
            rate_dIX,
            rate_dIXa,
            rate_dIXa_VIIIa,
            rate_dK,
            rate_dP,
            rate_dPC,
            rate_dPS,
            rate_dPg,
            rate_dPk,
            rate_dTAT,
            rate_dTF,
            rate_dTFPI,
            rate_dTmod,
            rate_dV,
            rate_dVII,
            rate_dVIII,
            rate_dVIIIa,
            rate_dVII_TF,
            rate_dVIIa,
            rate_dVIIa_TF,
            rate_dVIIa_TF_Xa_TFPI,
            rate_dVK,
            rate_dVKH2,
            rate_dVa,
            rate_dVa_Xa,
            rate_dX,
            rate_dXF,
            rate_dXI,
            rate_dXII,
            rate_dXIII,
            rate_dXIIIa,
            rate_dXIIa,
            rate_dXIa,
            rate_dXa,
            rate_dXa_TFPI,
            rate_eHeparin,
            rate_eHeparinIIa,
            rate_eHeparinIXa,
            rate_eHeparinXa,
            rate_pFg,
            rate_pII_VKH2,
            rate_pIX_VKH2,
            rate_pPC_VKH2,
            rate_pPS_VKH2,
            rate_pPg,
            rate_pPk,
            rate_pTFPI,
            rate_pTmod,
            rate_pV,
            rate_pVIII,
            rate_pVII_VKH2,
            rate_pVK,
            rate_pXI,
            rate_pXII,
            rate_pXIII,
            rate_pX_VKH2,
            rate_r10,
            rate_r11,
            rate_r12,
            rate_r13,
            rate_r14,
            rate_r15,
            rate_r16,
            rate_r17,
            rate_r18,
            rate_r19,
            rate_r1_,
            rate_r20,
            rate_r21,
            rate_r22,
            rate_r23,
            rate_r24,
            rate_r25,
            rate_r26,
            rate_r27,
            rate_r28,
            rate_r29,
            rate_r2_,
            rate_r30,
            rate_r31,
            rate_r32,
            rate_r33,
            rate_r34,
            rate_r35,
            rate_r36,
            rate_r37,
            rate_r38,
            rate_r39,
            rate_r3_,
            rate_r40,
            rate_r41,
            rate_r42,
            rate_r43,
            rate_r44,
            rate_r45,
            rate_r46,
            rate_r47,
            rate_r48,
            rate_r4_,
            rate_r5_,
            rate_r6_,
            rate_r7_,
            rate_r8_,
            rate_r9_,
            compartment_1,
            x_values[0]/compartment_1,
            x_values[1]/compartment_1,
            x_values[2]/compartment_1,
            x_values[3]/compartment_1,
            x_values[4]/compartment_1,
            x_values[5]/compartment_1,
            x_values[6]/compartment_1,
            compartment_1_DP/compartment_1,
            x_values[7]/compartment_1,
            x_values[8]/compartment_1,
            x_values[9]/compartment_1,
            x_values[10]/compartment_1,
            x_values[11]/compartment_1,
            x_values[12]/compartment_1,
            x_values[13]/compartment_1,
            x_values[14]/compartment_1,
            x_values[15]/compartment_1,
            x_values[16]/compartment_1,
            x_values[17]/compartment_1,
            x_values[18]/compartment_1,
            x_values[19]/compartment_1,
            x_values[20]/compartment_1,
            x_values[21]/compartment_1,
            x_values[22]/compartment_1,
            x_values[23]/compartment_1,
            x_values[24]/compartment_1,
            x_values[25]/compartment_1,
            x_values[26]/compartment_1,
            x_values[27]/compartment_1,
            x_values[28]/compartment_1,
            x_values[29]/compartment_1,
            x_values[30]/compartment_1,
            x_values[31]/compartment_1,
            x_values[32]/compartment_1,
            x_values[33]/compartment_1,
            x_values[34]/compartment_1,
            x_values[35]/compartment_1,
            x_values[36]/compartment_1,
            x_values[37]/compartment_1,
            x_values[38]/compartment_1,
            x_values[39]/compartment_1,
            x_values[40]/compartment_1,
            x_values[41]/compartment_1,
            x_values[42]/compartment_1,
            x_values[43]/compartment_1,
            x_values[44]/compartment_1,
            x_values[45]/compartment_1,
            x_values[46]/compartment_1,
            x_values[47]/compartment_1,
            x_values[48]/compartment_1,
            x_values[49]/compartment_1,
            x_values[50]/compartment_1,
            x_values[51]/compartment_1,
            x_values[52]/compartment_1,
            Fg0,
            Heparin_ke,
            IC50,
            II0,
            IX0,
            I_max,
            x_values[53],
            PC0,
            PS0,
            Pg0,
            Pk0,
            R1,
            R2,
            TFPI0,
            Tmod0,
            V0,
            VII0,
            VIII0,
            VK0,
            VKH20,
            VKO0,
            VitaminK_Vc,
            VitaminK_k12,
            VitaminK_k21_Vc,
            Warfarin_CL,
            Warfarin_Vd,
            Warfarin_ka,
            Warfarin_ke,
            X0,
            XI0,
            XII0,
            XIII0,
            c44,
            c45,
            c46,
            clottingTime_s,
            dAPC_PS_k1,
            dAPC_k1,
            dCA_k1,
            dD_k1,
            dFDP_k1,
            dF_k1,
            dIIa_Tmod_k1,
            dIIa_k1,
            dIXa_VIIIa_k1,
            dIXa_k1,
            dK_k1,
            dP_k1,
            dTAT_k1,
            dTF_k1,
            dVIIIa_k1,
            dVII_TF_k1,
            dVIIa_TF_Xa_TFPI_k1,
            dVIIa_TF_k1,
            dVIIa_k1,
            dVa_Xa_k1,
            dVa_k1,
            dXF_k1,
            dXIIIa_k1,
            dXIIa_k1,
            dXI_k1,
            dXIa_k1,
            dXa_TFPI_k1,
            dXa_k1,
            d_Fg,
            d_II,
            d_IX,
            d_PC,
            d_PS,
            d_Pg,
            d_Pk,
            d_TFPI,
            d_Tmod,
            d_V,
            d_VII,
            d_VIII,
            d_VK,
            d_VK2,
            d_VKH2,
            d_VKO,
            d_X,
            d_XI,
            d_XII,
            d_XIII,
            r10_k,
            r10_v,
            r11_k,
            r11_v,
            r12_k,
            r12_v,
            r13_k,
            r13_v,
            r14_k,
            r14_v,
            r15_k,
            r15_v,
            r16_k,
            r16_v,
            r17_k,
            r17_v,
            r18_k,
            r18_v,
            r19_k,
            r19_v,
            r1__k,
            r1__v,
            r20_k,
            r20_v,
            r21_k,
            r21_v,
            r22_k,
            r22_v,
            r23_k,
            r23_v,
            r24_k,
            r24_v,
            r25_k,
            r25_v,
            r26_c,
            r27_c,
            r28_c,
            r29_c,
            r2__k,
            r2__v,
            r30_c,
            r31_c,
            r32_c,
            r33_k,
            r33_v,
            r34_k,
            r34_v,
            r35_k,
            r35_v,
            r36_k,
            r36_v,
            r37_c,
            r38_k,
            r38_v,
            r39_k,
            r39_v,
            r3__k,
            r3__v,
            r40_k,
            r40_v,
            r41_k,
            r41_v,
            r42_k,
            r42_v,
            r43_k,
            r43_v,
            r4__k,
            r4__v,
            r5__k,
            r5__v,
            r6__k,
            r6__v,
            r7__k,
            r7__v,
            r8__k,
            r8__v,
            r9__k,
            r9__v,
            time,
        };
    }


    @Override
    public final void setCurrentValues(double[] values) throws Exception
    {
        CONSTRAINTS__VIOLATED = 0;
        rate_VK_transport = values[0];        
        rate_dAPC = values[1];        
        rate_dAPC_PS = values[2];        
        rate_dCA = values[3];        
        rate_dD = values[4];        
        rate_dF = values[5];        
        rate_dFDP = values[6];        
        rate_dFg = values[7];        
        rate_dII = values[8];        
        rate_dIIa = values[9];        
        rate_dIIa_Tmod = values[10];        
        rate_dIX = values[11];        
        rate_dIXa = values[12];        
        rate_dIXa_VIIIa = values[13];        
        rate_dK = values[14];        
        rate_dP = values[15];        
        rate_dPC = values[16];        
        rate_dPS = values[17];        
        rate_dPg = values[18];        
        rate_dPk = values[19];        
        rate_dTAT = values[20];        
        rate_dTF = values[21];        
        rate_dTFPI = values[22];        
        rate_dTmod = values[23];        
        rate_dV = values[24];        
        rate_dVII = values[25];        
        rate_dVIII = values[26];        
        rate_dVIIIa = values[27];        
        rate_dVII_TF = values[28];        
        rate_dVIIa = values[29];        
        rate_dVIIa_TF = values[30];        
        rate_dVIIa_TF_Xa_TFPI = values[31];        
        rate_dVK = values[32];        
        rate_dVKH2 = values[33];        
        rate_dVa = values[34];        
        rate_dVa_Xa = values[35];        
        rate_dX = values[36];        
        rate_dXF = values[37];        
        rate_dXI = values[38];        
        rate_dXII = values[39];        
        rate_dXIII = values[40];        
        rate_dXIIIa = values[41];        
        rate_dXIIa = values[42];        
        rate_dXIa = values[43];        
        rate_dXa = values[44];        
        rate_dXa_TFPI = values[45];        
        rate_eHeparin = values[46];        
        rate_eHeparinIIa = values[47];        
        rate_eHeparinIXa = values[48];        
        rate_eHeparinXa = values[49];        
        rate_pFg = values[50];        
        rate_pII_VKH2 = values[51];        
        rate_pIX_VKH2 = values[52];        
        rate_pPC_VKH2 = values[53];        
        rate_pPS_VKH2 = values[54];        
        rate_pPg = values[55];        
        rate_pPk = values[56];        
        rate_pTFPI = values[57];        
        rate_pTmod = values[58];        
        rate_pV = values[59];        
        rate_pVIII = values[60];        
        rate_pVII_VKH2 = values[61];        
        rate_pVK = values[62];        
        rate_pXI = values[63];        
        rate_pXII = values[64];        
        rate_pXIII = values[65];        
        rate_pX_VKH2 = values[66];        
        rate_r10 = values[67];        
        rate_r11 = values[68];        
        rate_r12 = values[69];        
        rate_r13 = values[70];        
        rate_r14 = values[71];        
        rate_r15 = values[72];        
        rate_r16 = values[73];        
        rate_r17 = values[74];        
        rate_r18 = values[75];        
        rate_r19 = values[76];        
        rate_r1_ = values[77];        
        rate_r20 = values[78];        
        rate_r21 = values[79];        
        rate_r22 = values[80];        
        rate_r23 = values[81];        
        rate_r24 = values[82];        
        rate_r25 = values[83];        
        rate_r26 = values[84];        
        rate_r27 = values[85];        
        rate_r28 = values[86];        
        rate_r29 = values[87];        
        rate_r2_ = values[88];        
        rate_r30 = values[89];        
        rate_r31 = values[90];        
        rate_r32 = values[91];        
        rate_r33 = values[92];        
        rate_r34 = values[93];        
        rate_r35 = values[94];        
        rate_r36 = values[95];        
        rate_r37 = values[96];        
        rate_r38 = values[97];        
        rate_r39 = values[98];        
        rate_r3_ = values[99];        
        rate_r40 = values[100];        
        rate_r41 = values[101];        
        rate_r42 = values[102];        
        rate_r43 = values[103];        
        rate_r44 = values[104];        
        rate_r45 = values[105];        
        rate_r46 = values[106];        
        rate_r47 = values[107];        
        rate_r48 = values[108];        
        rate_r4_ = values[109];        
        rate_r5_ = values[110];        
        rate_r6_ = values[111];        
        rate_r7_ = values[112];        
        rate_r8_ = values[113];        
        rate_r9_ = values[114];        
        compartment_1 = values[115];        
        x_values[0] = values[116];        
        x_values[1] = values[117];        
        x_values[2] = values[118];        
        x_values[3] = values[119];        
        x_values[4] = values[120];        
        x_values[5] = values[121];        
        x_values[6] = values[122];        
        compartment_1_DP = values[123];        
        x_values[7] = values[124];        
        x_values[8] = values[125];        
        x_values[9] = values[126];        
        x_values[10] = values[127];        
        x_values[11] = values[128];        
        x_values[12] = values[129];        
        x_values[13] = values[130];        
        x_values[14] = values[131];        
        x_values[15] = values[132];        
        x_values[16] = values[133];        
        x_values[17] = values[134];        
        x_values[18] = values[135];        
        x_values[19] = values[136];        
        x_values[20] = values[137];        
        x_values[21] = values[138];        
        x_values[22] = values[139];        
        x_values[23] = values[140];        
        x_values[24] = values[141];        
        x_values[25] = values[142];        
        x_values[26] = values[143];        
        x_values[27] = values[144];        
        x_values[28] = values[145];        
        x_values[29] = values[146];        
        x_values[30] = values[147];        
        x_values[31] = values[148];        
        x_values[32] = values[149];        
        x_values[33] = values[150];        
        x_values[34] = values[151];        
        x_values[35] = values[152];        
        x_values[36] = values[153];        
        x_values[37] = values[154];        
        x_values[38] = values[155];        
        x_values[39] = values[156];        
        x_values[40] = values[157];        
        x_values[41] = values[158];        
        x_values[42] = values[159];        
        x_values[43] = values[160];        
        x_values[44] = values[161];        
        x_values[45] = values[162];        
        x_values[46] = values[163];        
        x_values[47] = values[164];        
        x_values[48] = values[165];        
        x_values[49] = values[166];        
        x_values[50] = values[167];        
        x_values[51] = values[168];        
        x_values[52] = values[169];        
        Fg0 = values[170];        
        Heparin_ke = values[171];        
        IC50 = values[172];        
        II0 = values[173];        
        IX0 = values[174];        
        I_max = values[175];        
        x_values[53] = values[176];        
        PC0 = values[177];        
        PS0 = values[178];        
        Pg0 = values[179];        
        Pk0 = values[180];        
        R1 = values[181];        
        R2 = values[182];        
        TFPI0 = values[183];        
        Tmod0 = values[184];        
        V0 = values[185];        
        VII0 = values[186];        
        VIII0 = values[187];        
        VK0 = values[188];        
        VKH20 = values[189];        
        VKO0 = values[190];        
        VitaminK_Vc = values[191];        
        VitaminK_k12 = values[192];        
        VitaminK_k21_Vc = values[193];        
        Warfarin_CL = values[194];        
        Warfarin_Vd = values[195];        
        Warfarin_ka = values[196];        
        Warfarin_ke = values[197];        
        X0 = values[198];        
        XI0 = values[199];        
        XII0 = values[200];        
        XIII0 = values[201];        
        c44 = values[202];        
        c45 = values[203];        
        c46 = values[204];        
        clottingTime_s = values[205];        
        dAPC_PS_k1 = values[206];        
        dAPC_k1 = values[207];        
        dCA_k1 = values[208];        
        dD_k1 = values[209];        
        dFDP_k1 = values[210];        
        dF_k1 = values[211];        
        dIIa_Tmod_k1 = values[212];        
        dIIa_k1 = values[213];        
        dIXa_VIIIa_k1 = values[214];        
        dIXa_k1 = values[215];        
        dK_k1 = values[216];        
        dP_k1 = values[217];        
        dTAT_k1 = values[218];        
        dTF_k1 = values[219];        
        dVIIIa_k1 = values[220];        
        dVII_TF_k1 = values[221];        
        dVIIa_TF_Xa_TFPI_k1 = values[222];        
        dVIIa_TF_k1 = values[223];        
        dVIIa_k1 = values[224];        
        dVa_Xa_k1 = values[225];        
        dVa_k1 = values[226];        
        dXF_k1 = values[227];        
        dXIIIa_k1 = values[228];        
        dXIIa_k1 = values[229];        
        dXI_k1 = values[230];        
        dXIa_k1 = values[231];        
        dXa_TFPI_k1 = values[232];        
        dXa_k1 = values[233];        
        d_Fg = values[234];        
        d_II = values[235];        
        d_IX = values[236];        
        d_PC = values[237];        
        d_PS = values[238];        
        d_Pg = values[239];        
        d_Pk = values[240];        
        d_TFPI = values[241];        
        d_Tmod = values[242];        
        d_V = values[243];        
        d_VII = values[244];        
        d_VIII = values[245];        
        d_VK = values[246];        
        d_VK2 = values[247];        
        d_VKH2 = values[248];        
        d_VKO = values[249];        
        d_X = values[250];        
        d_XI = values[251];        
        d_XII = values[252];        
        d_XIII = values[253];        
        r10_k = values[254];        
        r10_v = values[255];        
        r11_k = values[256];        
        r11_v = values[257];        
        r12_k = values[258];        
        r12_v = values[259];        
        r13_k = values[260];        
        r13_v = values[261];        
        r14_k = values[262];        
        r14_v = values[263];        
        r15_k = values[264];        
        r15_v = values[265];        
        r16_k = values[266];        
        r16_v = values[267];        
        r17_k = values[268];        
        r17_v = values[269];        
        r18_k = values[270];        
        r18_v = values[271];        
        r19_k = values[272];        
        r19_v = values[273];        
        r1__k = values[274];        
        r1__v = values[275];        
        r20_k = values[276];        
        r20_v = values[277];        
        r21_k = values[278];        
        r21_v = values[279];        
        r22_k = values[280];        
        r22_v = values[281];        
        r23_k = values[282];        
        r23_v = values[283];        
        r24_k = values[284];        
        r24_v = values[285];        
        r25_k = values[286];        
        r25_v = values[287];        
        r26_c = values[288];        
        r27_c = values[289];        
        r28_c = values[290];        
        r29_c = values[291];        
        r2__k = values[292];        
        r2__v = values[293];        
        r30_c = values[294];        
        r31_c = values[295];        
        r32_c = values[296];        
        r33_k = values[297];        
        r33_v = values[298];        
        r34_k = values[299];        
        r34_v = values[300];        
        r35_k = values[301];        
        r35_v = values[302];        
        r36_k = values[303];        
        r36_v = values[304];        
        r37_c = values[305];        
        r38_k = values[306];        
        r38_v = values[307];        
        r39_k = values[308];        
        r39_v = values[309];        
        r3__k = values[310];        
        r3__v = values[311];        
        r40_k = values[312];        
        r40_v = values[313];        
        r41_k = values[314];        
        r41_v = values[315];        
        r42_k = values[316];        
        r42_v = values[317];        
        r43_k = values[318];        
        r43_v = values[319];        
        r4__k = values[320];        
        r4__v = values[321];        
        r5__k = values[322];        
        r5__v = values[323];        
        r6__k = values[324];        
        r6__v = values[325];        
        r7__k = values[326];        
        r7__v = values[327];        
        r8__k = values[328];        
        r8__v = values[329];        
        r9__k = values[330];        
        r9__v = values[331];        
        time = values[332];        
        if ( time == 0 )
        {
           initialValues[0] = values[116];        
           initialValues[1] = values[117];        
           initialValues[2] = values[118];        
           initialValues[3] = values[119];        
           initialValues[4] = values[120];        
           initialValues[5] = values[121];        
           initialValues[6] = values[122];        
           initialValues[7] = values[124];        
           initialValues[8] = values[125];        
           initialValues[9] = values[126];        
           initialValues[10] = values[127];        
           initialValues[11] = values[128];        
           initialValues[12] = values[129];        
           initialValues[13] = values[130];        
           initialValues[14] = values[131];        
           initialValues[15] = values[132];        
           initialValues[16] = values[133];        
           initialValues[17] = values[134];        
           initialValues[18] = values[135];        
           initialValues[19] = values[136];        
           initialValues[20] = values[137];        
           initialValues[21] = values[138];        
           initialValues[22] = values[139];        
           initialValues[23] = values[140];        
           initialValues[24] = values[141];        
           initialValues[25] = values[142];        
           initialValues[26] = values[143];        
           initialValues[27] = values[144];        
           initialValues[28] = values[145];        
           initialValues[29] = values[146];        
           initialValues[30] = values[147];        
           initialValues[31] = values[148];        
           initialValues[32] = values[149];        
           initialValues[33] = values[150];        
           initialValues[34] = values[151];        
           initialValues[35] = values[152];        
           initialValues[36] = values[153];        
           initialValues[37] = values[154];        
           initialValues[38] = values[155];        
           initialValues[39] = values[156];        
           initialValues[40] = values[157];        
           initialValues[41] = values[158];        
           initialValues[42] = values[159];        
           initialValues[43] = values[160];        
           initialValues[44] = values[161];        
           initialValues[45] = values[162];        
           initialValues[46] = values[163];        
           initialValues[47] = values[164];        
           initialValues[48] = values[165];        
           initialValues[49] = values[166];        
           initialValues[50] = values[167];        
           initialValues[51] = values[168];        
           initialValues[52] = values[169];        
           initialValues[53] = values[176];        
           calculateInitialParameters();  
        }
        else
           calculateParameters();
    }




    public final double[] checkEvent(double time, double[] x_values) throws Exception
    {
        this.time = time;
        this.x_values = x_values;
        calculateParameters();
        double[] z  = new double[4];
        z[0] = (NUMERIC_GT(x_values[53]*3600.0, 1500.0) != 0) ? 1 : -1; // clottingTime_event part1;
        z[1] = (NUMERIC_GT(x_values[53]*3600.0, 1500.0) != 0) ? 1 : -1; // clottingTime_event part2;
        z[2] = (NUMERIC_GT(time, 0.0) != 0) ? 1 : -1; // dilution_event part1;
        z[3] = (NUMERIC_GT(time, 0.0) != 0) ? 1 : -1; // dilution_event part2;
        return z;
    }


    public final void processEvent(int i)
    {
        double[] assignments;
        double executionTime;
        switch ( i )
        {
            case ( 0 ): //clottingTime_event part1
            {
                assignments = new double[2 - 1];
                executionTime = time;
                assignments[1 - 1] = time*3600.0;
                addDelayedEvent(0 + 1, executionTime, assignments);
                break;
            }
            case ( 1 ): //clottingTime_event part2
            {
                assignments = getNextAssignments(1);
                clottingTime_s = assignments[0] * 1.0;
                removeDelayedEvent(1);
                break;
            }
            case ( 2 ): //dilution_event part1
            {
                assignments = new double[2 - 1];
                executionTime = time;
                assignments[1 - 1] = compartment_1*3.0;
                addDelayedEvent(2 + 1, executionTime, assignments);
                break;
            }
            case ( 3 ): //dilution_event part2
            {
                assignments = getNextAssignments(3);
                compartment_1 = assignments[0] * 1.0;
                removeDelayedEvent(3);
                break;
            }
            default:
                break;
        }
    }


    public final double[] getEventsPriority(double time, double[] x_values) throws Exception
    {
        calculateParameters();
    return new double[] {
        Double.POSITIVE_INFINITY, //clottingTime_event part1
        Double.NEGATIVE_INFINITY, //clottingTime_event part2
        Double.POSITIVE_INFINITY, //dilution_event part1
        Double.NEGATIVE_INFINITY, //dilution_event part2
        };
    }



    public final boolean getEventsInitialValue(int i) throws IndexOutOfBoundsException
    {
        return true;
    }


    public final boolean isEventTriggerPersistent(int i) throws IndexOutOfBoundsException
    {
        return true;
    }


    public final String getEventMessage(int i) throws IndexOutOfBoundsException
    {
        return null;
    }
}
